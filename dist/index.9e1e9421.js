function t(t){return t&&t.__esModule?t.default:t}function e(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}var n,i,r={};
/*! Tweakpane 3.0.7 (c) 2016 cocopon, licensed under the MIT license. */function o(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t).value}function s(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");var i=e.get(t);if(!i.writable)throw new TypeError("attempted to set read only private field");return i.value=n,n}function a(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n=r,i=function(t){class e{get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}constructor(t){this.controller_=t}}class n{constructor(t){this.target=t}}class i extends n{constructor(t,e,n,i){super(t),this.value=e,this.presetKey=n,this.last=null==i||i}}class r extends n{constructor(t,e,n){super(t),this.value=e,this.presetKey=n}}class o extends n{constructor(t,e){super(t),this.expanded=e}}function s(t){return null==t}function a(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const l={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class u{static alreadyDisposed(){return new u({type:"alreadydisposed"})}static notBindable(){return new u({type:"notbindable"})}static propertyNotFound(t){return new u({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new u({type:"shouldneverhappen"})}constructor(t){var e;this.message=null!==(e=l[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class c{static isBindable(t){return null!==t&&"object"==typeof t}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const n=this.read();if(!c.isBindable(n))throw u.notBindable();if(!(t in n))throw u.propertyNotFound(t);n[t]=e}constructor(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=null!=n?n:e}}class h extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{i(new n(this))})),this}}class p{on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}constructor(){this.observers_={}}}const d="tp";function v(t){return(e,n)=>[d,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function m(t){return t.rawValue}function f(t,e){var n,i;t.emitter.on("change",(n=m,i=e,t=>i(n(t)))),e(t.rawValue)}function b(t,e,n){f(t.value(e),n)}function _(t,e){return n=>{!function(t,e,n){n?t.classList.add(e):t.classList.remove(e)}(t,e,n)}}function g(t,e){f(t,(t=>{e.textContent=null!=t?t:""}))}const w=v("btn");class x{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(w()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(w("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(w("t")),g(e.props.value("title"),i),this.buttonElement.appendChild(i)}}class y{onClick_(){this.emitter.emit("click",{sender:this})}constructor(t,e){this.emitter=new p,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new x(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}}class C{get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new p,this.rawValue_=t}}class E{get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}constructor(t){this.emitter=new p,this.value_=t}}function P(t,e){const n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new C(t,e):new E(t)}class M{static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:P(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new M(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}constructor(t){this.emitter=new p,this.valMap_=t;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",(()=>{this.emitter.emit("change",{key:t,sender:this})}))}}function k(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function V(t){return{custom:e=>k(e)(t),boolean:k((t=>"boolean"==typeof t?t:void 0))(t),number:k((t=>"number"==typeof t?t:void 0))(t),string:k((t=>"string"==typeof t?t:void 0))(t),function:k((t=>"function"==typeof t?t:void 0))(t),constant:e=>k((t=>t===e?e:void 0))(t),raw:k((t=>t))(t),object:e=>k((t=>{var n;if(null!==(n=t)&&"object"==typeof n)return function(t,e){return Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),{[i]:r.value}):void 0}),{})}(t,e)}))(t),array:e=>k((t=>{var n;if(Array.isArray(t))return n=e,t.reduce(((t,e)=>{if(void 0===t)return;const i=n(e);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}))(t)}}const A={optional:V(!0),required:V(!1)};function R(t,e){const n=A.required.object(e)(t);return n.succeeded?n.value:void 0}const T=v(""),L={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class S{get parent(){return this.parent_}constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((t=>{e.classList.remove(T(void 0,L[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(T(void 0,L[t]))}))})),this.viewProps.handleDispose((()=>{!function(t){t&&t.parentElement&&t.parentElement.removeChild(t)}(e)}))}}const B="http://www.w3.org/2000/svg";function F(t){t.offsetHeight}function D(t){return void 0!==t.ontouchstart}function U(){return new Function("return this")().document}const I={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function N(t,e){const n=t.createElementNS(B,"svg");return n.innerHTML=I[e],n}function O(t,e,n){t.insertBefore(e,t.children[n])}function j(t){t.parentElement&&t.parentElement.removeChild(t)}function z(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function K(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const H=v("lbl");class q{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(H()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(H("l")),b(e.props,"label",(e=>{s(e)?this.element.classList.add(H(void 0,"nol")):(this.element.classList.remove(H(void 0,"nol")),function(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}(n),n.appendChild(function(t,e){const n=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,i)=>{i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}(t,e)))})),this.element.appendChild(n),this.labelElement=n;const i=t.createElement("div");i.classList.add(H("v")),this.element.appendChild(i),this.valueElement=i}}class G extends S{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new q(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const W={id:"button",type:"blade",accept(t){const e=A,n=R(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:t=>new G(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:new y(t.document,{props:M.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof G&&t.controller.valueController instanceof y?new h(t.controller):null};class X extends S{constructor(t){super(t),this.value=t.value}}function $(){return new M({positions:P([],{equals:a})})}class Y extends M{static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=M.createCore(e);return new Y(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){b(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}constructor(t){super(t)}}function Q(t,e){e.style.height=t.styleHeight}function Z(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",function(t,e){let n=0;return function(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),F(e),n=e.clientHeight,t.set("temporaryExpanded",null),F(e)})),n}(t,e)),t.set("shouldFixHeight",!0),F(e)})),t.emitter.on("change",(()=>{Q(t,e)})),Q(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class J extends e{constructor(t,e){super(t),this.rackApi_=e}}class tt{get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw u.shouldNeverHappen();const n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);const i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:n,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}constructor(t){this.emitter=new p,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}}class et extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new i(this,e,this.controller_.binding.target.presetKey,t.options.last)})}constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new p,this.controller_.binding.emitter.on("change",this.onBindingChange_)}}class nt extends G{constructor(t,e){super(t,e),this.binding=e.binding}}class it extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new r(this,e,this.controller_.binding.target.presetKey)})}constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new p,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}}class rt extends G{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function ot(t){return t instanceof lt?t.apiSet_:t instanceof J?t.rackApi_.apiSet_:null}function st(t,e){const n=t.find((t=>t.controller_===e));if(!n)throw u.shouldNeverHappen();return n}function at(t,e,n){if(!c.isBindable(t))throw u.notBindable();return new c(t,e,n)}class lt extends e{get children(){return this.controller_.rack.children.map((t=>st(this.apiSet_,t)))}addInput(t,e,n){const i=n||{},r=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(r,at(t,e,i.presetKey),i),s=new et(o);return this.add(s,i.index)}addMonitor(t,e,n){const i=n||{},r=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(r,at(t,e),i),s=new it(o);return this.add(s,i.index)}addFolder(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}(this,t)}addButton(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}(this,t)}addSeparator(t){return function(t,e){const n=e||{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}(this,t)}addTab(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const n=this.apiSet_.find((e=>e.controller_===t.controller_));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),i=this.pool_.createBladeApi(n);return this.add(i,t.index)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=st(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof nt){const n=st(this.apiSet_,e),r=e.binding;this.emitter_.emit("change",{event:new i(n,r.target.read(),r.target.presetKey,t.options.last)})}else if(e instanceof X){const n=st(this.apiSet_,e);this.emitter_.emit("change",{event:new i(n,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof rt))throw u.shouldNeverHappen();const e=st(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new r(e,n.target.read(),n.target.presetKey)})}constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new p,this.apiSet_=new tt(ot),this.pool_=e;const n=this.controller_.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),n.emitter.on("inputchange",this.onRackInputChange_),n.emitter.on("monitorupdate",this.onRackMonitorUpdate_),n.children.forEach((t=>{this.setUpApi_(t)}))}}class ut extends J{get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t,e){super(t,new lt(t.rackController,e)),this.emitter_=new p,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new o(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}}class ct extends S{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class ht{constructor(t,e){const n=v(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}function pt(t){return t instanceof mt?t.rack:t instanceof ct?t.rackController.rack:null}function dt(t){const e=pt(t);return e?e.bcSet_:null}class vt{get children(){return this.bcSet_.items}add(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}remove(t){t.parent_=null,this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter((e=>e instanceof t))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof nt)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof rt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof X)n.value.emitter.on("change",this.onChildValueChange_);else{const t=pt(n);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const n=t.item;if(n instanceof nt)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof rt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof X)n.value.emitter.off("change",this.onChildValueChange_);else{const t=pt(n);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],n=t[t.length-1];this.bcSet_.items.forEach((t=>{const i=[];t===e&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),t===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),t.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=function(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof nt&&i.binding===e)return i}return null}(this.find(nt),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=function(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof rt&&i.binding===e)return i}return null}(this.find(rt),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=function(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof X&&i.value===e)return i}return null}(this.find(X),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}constructor(t){var e;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new p,this.blade_=null!=t?t:null,null===(e=this.blade_)||void 0===e||e.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new tt(dt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}}class mt extends S{onRackAdd_(t){t.isRoot&&O(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&j(t.bladeController.view.element)}constructor(t,e){super(Object.assign(Object.assign({},e),{view:new ht(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=new vt(e.root?void 0:e.blade);n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)}))}}const ft=v("cnt");class bt{constructor(t,e){this.className_=v(e.viewName||"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),ft()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),b(this.foldable_,"completed",_(this.element,this.className_(void 0,"cpl")));const n=t.createElement("button");n.classList.add(this.className_("b")),b(e.props,"title",(t=>{s(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(this.className_("t")),g(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i;const r=t.createElement("div");r.classList.add(this.className_("m")),this.buttonElement.appendChild(r);const o=e.containerElement;o.classList.add(this.className_("c")),this.element.appendChild(o),this.containerElement=o}}class _t extends ct{get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}constructor(t,e){var n;const i=Y.create(null===(n=e.expanded)||void 0===n||n),r=new mt(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:r,view:new bt(t,{containerElement:r.view.element,foldable:i,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=i,Z(this.foldable,this.view.containerElement),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}}const gt={id:"folder",type:"blade",accept(t){const e=A,n=R(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:t=>new _t(t.document,{blade:t.blade,expanded:t.params.expanded,props:M.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof _t?new ut(t.controller,t.pool):null};class wt extends X{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new q(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class xt extends e{}const yt=v("spr");class Ct{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(yt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("hr");n.classList.add(yt("r")),this.element.appendChild(n)}}class Et extends S{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Ct(t,{viewProps:e.viewProps})}))}}const Pt={id:"separator",type:"blade",accept(t){const e=R(t,{view:A.required.constant("separator")});return e?{params:e}:null},controller:t=>new Et(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof Et?new xt(t.controller):null},Mt=v("");function kt(t,e){return _(t,Mt(void 0,e))}class Vt extends M{static create(t){var e,n;const i=null!=t?t:{},r={disabled:null!==(e=i.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(n=i.hidden)&&void 0!==n&&n},o=M.createCore(r);return new Vt(o)}bindClassModifiers(t){b(this,"disabled",kt(t,"disabled")),b(this,"hidden",kt(t,"hidden"))}bindDisabled(t){b(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){b(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}constructor(t){super(t)}}const At=v("tbi");class Rt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(At()),e.viewProps.bindClassModifiers(this.element),b(e.props,"selected",(t=>{t?this.element.classList.add(At(void 0,"sel")):this.element.classList.remove(At(void 0,"sel"))}));const n=t.createElement("button");n.classList.add(At("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(At("t")),g(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class Tt{onClick_(){this.emitter.emit("click",{sender:this})}constructor(t,e){this.emitter=new p,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Rt(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}}class Lt{get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Tt(t,{props:e.itemProps,viewProps:Vt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new mt(t,{blade:$(),viewProps:Vt.create()}),this.props=e.props,b(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}}class St{get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addBlade(t){return this.rackApi_.addBlade(t)}constructor(t,e){this.controller_=t,this.rackApi_=e}}class Bt extends J{get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw u.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,n=new Lt(e,{itemProps:M.fromObject({selected:!1,title:t.title}),props:M.fromObject({selected:!1})});this.controller_.add(n,t.index);const i=this.pageApiMap_.get(n);if(!i)throw u.shouldNeverHappen();return i}removePage(t){this.controller_.remove(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw u.shouldNeverHappen();const n=new St(t,e);this.pageApiMap_.set(t,n)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw u.shouldNeverHappen();this.pageApiMap_.delete(t.item)}constructor(t,e){super(t,new lt(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new p,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}}const Ft=v("tab");class Dt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ft(),ft()),e.viewProps.bindClassModifiers(this.element),f(e.empty,_(this.element,Ft(void 0,"nop")));const n=t.createElement("div");n.classList.add(Ft("i")),this.element.appendChild(n),this.itemsElement=n;const i=e.contentsElement;i.classList.add(Ft("c")),this.element.appendChild(i),this.contentsElement=i}}class Ut extends ct{get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,null!=e?e:this.pageSet_.items.length)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}onPageAdd_(t){const e=t.item;O(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),e.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(t){const e=t.item;j(e.itemController.view.element),this.rackController.rack.remove(e.contentController),e.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(0===this.pageSet_.items.length)return;const t=this.pageSet_.items.findIndex((t=>t.props.get("selected")));t<0?this.pageSet_.items.forEach(((t,e)=>{t.props.set("selected",0===e)})):this.pageSet_.items.forEach(((e,n)=>{e.props.set("selected",n===t)}))}onPageSelectedChange_(t){if(t.rawValue){const e=this.pageSet_.items.findIndex((e=>e.props.value("selected")===t.sender));this.pageSet_.items.forEach(((t,n)=>{t.props.set("selected",n===e)}))}else this.keepSelection_()}constructor(t,e){const n=new mt(t,{blade:e.blade,viewProps:e.viewProps}),i=P(!0);super({blade:e.blade,rackController:n,view:new Dt(t,{contentsElement:n.view.element,empty:i,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new tt((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=i,this.applyPages_()}}const It={id:"tab",type:"blade",accept(t){const e=A,n=R(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller(t){const e=new Ut(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((n=>{const i=new Lt(t.document,{itemProps:M.fromObject({selected:!1,title:n.title}),props:M.fromObject({selected:!1})});e.add(i)})),e},api:t=>t.controller instanceof Ut?new Bt(t.controller,t.pool):null};class Nt{dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}constructor(){this.disabled=!1,this.emitter=new p}}class Ot{get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new p,this.interval_=e,this.setTimer_()}}class jt{constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}constructor(t){this.constraints=t}}function zt(t,e){if(t instanceof e)return t;if(t instanceof jt){const n=t.constraints.reduce(((t,n)=>t||(n instanceof e?n:null)),null);if(n)return n}return null}class Kt{constrain(t){const e=this.options;return 0===e.length||e.filter((e=>e.value===t)).length>0?t:e[0].value}constructor(t){this.options=t}}class Ht{constrain(t){let e=t;return s(this.minValue)||(e=Math.max(e,this.minValue)),s(this.maxValue)||(e=Math.min(e,this.maxValue)),e}constructor(t){this.maxValue=t.max,this.minValue=t.min}}class qt{constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}constructor(t){this.step=t}}const Gt=v("lst");class Wt{update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(Gt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("select");n.classList.add(Gt("s")),b(this.props_,"options",(e=>{z(n),e.forEach(((e,i)=>{const r=t.createElement("option");r.dataset.index=String(i),r.textContent=e.text,r.value=String(e.value),n.appendChild(r)}))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=t.createElement("div");i.classList.add(Gt("m")),i.appendChild(N(t,"dropdown")),this.element.appendChild(i),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}}class Xt{onSelectChange_(t){const e=t.currentTarget.selectedOptions.item(0);if(!e)return;const n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Wt(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}}const $t=v("pop");class Yt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add($t()),e.viewProps.bindClassModifiers(this.element),f(e.shows,_(this.element,$t(void 0,"v")))}}class Qt{constructor(t,e){this.shows=P(!1),this.viewProps=e.viewProps,this.view=new Yt(t,{shows:this.shows,viewProps:this.viewProps})}}const Zt=v("txt");class Jt{refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Zt()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(Zt("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}}class te{onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);s(n)||(this.value.rawValue=n),this.view.refresh()}constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Jt(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}}function ee(t){return"false"!==t&&!!t}function ne(t){return function(t){return String(t)}(t)}class ie{evaluate(){return Number(this.text)}toString(){return this.text}constructor(t){this.text=t}}const re={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class oe{evaluate(){const t=re[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}constructor(t,e,n){this.left=e,this.operator=t,this.right=n}}const se={"+":t=>t,"-":t=>-t,"~":t=>~t};class ae{evaluate(){const t=se[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}constructor(t,e){this.operator=t,this.expression=e}}function le(t){return(e,n)=>{for(let i=0;i<t.length;i++){const r=t[i](e,n);if(""!==r)return r}return""}}function ue(t,e){var n;const i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function ce(t,e){var n;const i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function he(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const i=function(t,e){const n=ce(t,e);if(""!==n)return n;const i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";const r=ce(t,e+=1);return""===r?"":i+r}(t,e);return""===i?"":n+i}function pe(t,e){const n=t.substr(e,1);if("0"===n)return n;const i=function(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}(t,e);return e+=i.length,""===i?"":i+ce(t,e)}const de=le([function(t,e){const n=pe(t,e);if(e+=n.length,""===n)return"";const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const r=ce(t,e);return n+i+r+he(t,e+=r.length)},function(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=ce(t,e);return e+=i.length,""===i?"":n+i+he(t,e)},function(t,e){const n=pe(t,e);return e+=n.length,""===n?"":n+he(t,e)}]),ve=le([function(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const i=function(t,e){var n;const i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(t,e);return""===i?"":n+i},function(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const i=function(t,e){var n;const i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}(t,e);return""===i?"":n+i},function(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const i=function(t,e){var n;const i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}(t,e);return""===i?"":n+i}]),me=le([ve,de]);function fe(t,e){return function(t,e){const n=me(t,e);return e+=n.length,""===n?null:{evaluable:new ie(n),cursor:e}}(t,e)||function(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const i=ge(t,e);if(!i)return null;e=i.cursor,e+=ue(t,e).length;const r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}(t,e)}function be(t,e,n){n+=ue(e,n).length;const i=t.filter((t=>e.startsWith(t,n)))[0];return i?(n+=i.length,{cursor:n+=ue(e,n).length,operator:i}):null}const _e=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>function(t,e){return(n,i)=>{const r=t(n,i);if(!r)return null;i=r.cursor;let o=r.evaluable;for(;;){const r=be(e,n,i);if(!r)break;i=r.cursor;const s=t(n,i);if(!s)return null;i=s.cursor,o=new oe(r.operator,o,s.evaluable)}return o?{cursor:i,evaluable:o}:null}}(t,e)),(function t(e,n){const i=fe(e,n);if(i)return i;const r=e.substr(n,1);if(n+=r.length,"+"!==r&&"-"!==r&&"~"!==r)return null;const o=t(e,n);return o?{cursor:n=o.cursor,evaluable:new ae(r,o.evaluable)}:null}));function ge(t,e){return e+=ue(t,e).length,_e(t,e)}function we(t){var e;const n=function(t){const e=ge(t,0);return e?e.cursor+ue(t,e.cursor).length!==t.length?null:e.evaluable:null}(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function xe(t){if("number"==typeof t)return t;if("string"==typeof t){const e=we(t);if(!s(e))return e}return 0}function ye(t){return String(t)}function Ce(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const Ee=Ce(0);function Pe(t){return Ee(t)+"%"}function Me(t){return String(t)}function ke(t){return t}function Ve(t,e){for(;t.length<e;)t.push(void 0)}function Ae(t){const e=[];return Ve(e,t),P(e)}function Re(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function Te({primary:t,secondary:e,forward:n,backward:i}){let r=!1;function o(t){r||(r=!0,t(),r=!1)}t.emitter.on("change",(i=>{o((()=>{e.setRawValue(n(t,e),i.options)}))})),e.emitter.on("change",(r=>{o((()=>{t.setRawValue(i(t,e),r.options)})),o((()=>{e.setRawValue(n(t,e),r.options)}))})),o((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function Le(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Se(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Be(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Fe(t){return function(t){return"ArrowUp"===t||"ArrowDown"===t}(t)||"ArrowLeft"===t||"ArrowRight"===t}function De(t,e){const n=e.ownerDocument.defaultView,i=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+i.left),y:t.pageY-((n&&n.scrollY||0)+i.top)}}class Ue{computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(De(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(De(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(De(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new p,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}}function Ie(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function Ne(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Oe(t,e,n){return Math.min(Math.max(t,e),n)}function je(t,e){return(t%e+e)%e}const ze=v("txt");class Ke{onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(ze(void 0,"drg"));this.element.classList.add(ze(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=Oe(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ze(),ze(void 0,"num")),e.arrayPosition&&this.element.classList.add(ze(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(ze("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ze()),this.inputElement.classList.add(ze("i"));const i=t.createElement("div");i.classList.add(ze("k")),this.element.appendChild(i),this.knobElement=i;const r=t.createElementNS(B,"svg");r.classList.add(ze("g")),this.knobElement.appendChild(r);const o=t.createElementNS(B,"path");o.classList.add(ze("gb")),r.appendChild(o),this.guideBodyElem_=o;const s=t.createElementNS(B,"path");s.classList.add(ze("gh")),r.appendChild(s),this.guideHeadElem_=s;const a=t.createElement("div");a.classList.add(v("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}}class He{onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);s(n)||(this.value.rawValue=n),this.view.refresh()}onInputKeyDown_(t){const e=Le(this.baseStep_,Se(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==Le(this.baseStep_,Se(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=P(null),this.view=new Ke(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new Ue(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}}const qe=v("sld");class Ge{update_(){const t=Oe(Ie(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(qe()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(qe("t")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=t.createElement("div");i.classList.add(qe("k")),this.trackElement.appendChild(i),this.knobElement=i,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}}class We{handlePointerEvent_(t,e){t.point&&this.value.setRawValue(Ie(Oe(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Le(this.baseStep_,Be(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Le(this.baseStep_,Be(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Ge(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}}const Xe=v("sldtxt");class $e{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Xe());const n=t.createElement("div");n.classList.add(Xe("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Xe("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class Ye{get sliderController(){return this.sliderC_}get textController(){return this.textC_}constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new We(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new He(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,value:e.value,viewProps:e.viewProps}),this.view=new $e(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}}function Qe(t,e){t.write(e)}function Ze(t){const e=A;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Je(t){if("inline"===t||"popup"===t)return t}function tn(t){const e=A;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function en(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((n=>{e.push({text:n,value:t[n]})})),e}function nn(t){return s(t)?null:new Kt(en(t))}function rn(t){const e=t?zt(t,Kt):null;return e?e.options:null}function on(t,e){const n=t&&zt(t,qt);return n?Ne(n.step):Math.max(Ne(e),2)}function sn(t){const e=function(t){const e=t?zt(t,qt):null;return e?e.step:null}(t);return null!=e?e:1}function an(t,e){var n;const i=t&&zt(t,qt),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}const ln=v("ckb");class un{update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ln()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(ln("l")),this.element.appendChild(n);const i=t.createElement("input");i.classList.add(ln("i")),i.type="checkbox",n.appendChild(i),this.inputElement=i,e.viewProps.bindDisabled(this.inputElement);const r=t.createElement("div");r.classList.add(ln("w")),n.appendChild(r);const o=N(t,"check");r.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}}class cn{onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new un(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}}const hn={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=R(e,{options:A.optional.custom(Ze)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>ee,constraint:t=>function(t){const e=[],n=nn(t.options);return n&&e.push(n),new jt(e)}(t.params),writer:t=>Qe},controller:t=>{var e;const n=t.document,i=t.value,r=t.constraint;return r&&zt(r,Kt)?new Xt(n,{props:M.fromObject({options:null!==(e=rn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new cn(n,{value:i,viewProps:t.viewProps})}},pn=v("col");class dn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pn()),e.foldable.bindExpandedClass(this.element,pn(void 0,"expanded")),b(e.foldable,"completed",_(this.element,pn(void 0,"cpl")));const n=t.createElement("div");n.classList.add(pn("h")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(pn("s")),n.appendChild(i),this.swatchElement=i;const r=t.createElement("div");if(r.classList.add(pn("t")),n.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(pn("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function vn(t,e,n){const i=je(t,360),r=Oe(e/100,0,1),o=Oe(n/100,0,1),s=o*r,a=s*(1-Math.abs(i/60%2-1)),l=o-s;let u,c,h;return[u,c,h]=i>=0&&i<60?[s,a,0]:i>=60&&i<120?[a,s,0]:i>=120&&i<180?[0,s,a]:i>=180&&i<240?[0,a,s]:i>=240&&i<300?[a,0,s]:[s,0,a],[255*(u+l),255*(c+l),255*(h+l)]}function mn(t){return[t[0],t[1],t[2]]}function fn(t,e){return[t[0],t[1],t[2],e]}const bn={hsl:{hsl:(t,e,n)=>[t,e,n],hsv:function(t,e,n){const i=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==i?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/200]},rgb:function(t,e,n){const i=(t%360+360)%360,r=Oe(e/100,0,1),o=Oe(n/100,0,1),s=(1-Math.abs(2*o-1))*r,a=s*(1-Math.abs(i/60%2-1)),l=o-s/2;let u,c,h;return[u,c,h]=i>=0&&i<60?[s,a,0]:i>=60&&i<120?[a,s,0]:i>=120&&i<180?[0,s,a]:i>=180&&i<240?[0,a,s]:i>=240&&i<300?[a,0,s]:[s,0,a],[255*(u+l),255*(c+l),255*(h+l)]}},hsv:{hsl:function(t,e,n){const i=100-Math.abs(n*(200-e)/100-100);return[t,0!==i?e*n/i:0,n*(200-e)/200]},hsv:(t,e,n)=>[t,e,n],rgb:vn},rgb:{hsl:function(t,e,n){const i=Oe(t/255,0,1),r=Oe(e/255,0,1),o=Oe(n/255,0,1),s=Math.max(i,r,o),a=Math.min(i,r,o),l=s-a;let u=0,c=0;const h=(a+s)/2;return 0!==l&&(c=l/(1-Math.abs(s+a-1)),u=i===s?(r-o)/l:r===s?2+(o-i)/l:4+(i-r)/l,u=u/6+(u<0?1:0)),[360*u,100*c,100*h]},hsv:function(t,e,n){const i=Oe(t/255,0,1),r=Oe(e/255,0,1),o=Oe(n/255,0,1),s=Math.max(i,r,o),a=s-Math.min(i,r,o);let l;return l=0===a?0:s===i?((r-o)/a%6+6)%6*60:s===r?60*((o-i)/a+2):60*((i-r)/a+4),[l,100*(0===s?0:a/s),100*s]},rgb:(t,e,n)=>[t,e,n]}},_n={hsl:t=>{var e;return[je(t[0],360),Oe(t[1],0,100),Oe(t[2],0,100),Oe(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},hsv:t=>{var e;return[je(t[0],360),Oe(t[1],0,100),Oe(t[2],0,100),Oe(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},rgb:t=>{var e;return[Oe(t[0],0,255),Oe(t[1],0,255),Oe(t[2],0,255),Oe(null!==(e=t[3])&&void 0!==e?e:1,0,1)]}};function gn(t,e){return"object"==typeof t&&!s(t)&&e in t&&"number"==typeof t[e]}class wn{static black(){return new wn([0,0,0],"rgb")}static fromObject(t){const e="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new wn(e,"rgb")}static toRgbaObject(t){return t.toRgbaObject()}static isRgbColorObject(t){return gn(t,"r")&&gn(t,"g")&&gn(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&gn(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode_!==e.mode_)return!1;const n=t.comps_,i=e.comps_;for(let t=0;t<n.length;t++)if(n[t]!==i[t])return!1;return!0}get mode(){return this.mode_}getComponents(t){return fn((e=mn(this.comps_),n=this.mode_,i=t||this.mode_,bn[n][i](...e)),this.comps_[3]);var e,n,i}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}constructor(t,e){this.mode_=e,this.comps_=_n[e](t)}}const xn=v("colp");class yn{get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(xn());const n=t.createElement("div");n.classList.add(xn("hsv"));const i=t.createElement("div");i.classList.add(xn("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const r=t.createElement("div");r.classList.add(xn("h")),this.hPaletteView_=e.hPaletteView,r.appendChild(this.hPaletteView_.element),n.appendChild(r),this.element.appendChild(n);const o=t.createElement("div");if(o.classList.add(xn("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const n=t.createElement("div");n.classList.add(xn("a"));const i=t.createElement("div");i.classList.add(xn("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const r=t.createElement("div");r.classList.add(xn("at")),r.appendChild(this.alphaViews_.text.element),n.appendChild(r),this.element.appendChild(n)}}}function Cn(t){const e=A;return R(t,{alpha:e.optional.boolean,expanded:e.optional.boolean,picker:e.optional.custom(Je)})}function En(t){return t?.1:1}function Pn(t,e){const n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}const Mn={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function kn(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const n=parseFloat(e[1]),i=e[2];return Mn[i](n)}const Vn={"func.rgb":t=>{const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Pn(e[1],255),Pn(e[2],255),Pn(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new wn(n,"rgb")},"func.rgba":t=>{const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Pn(e[1],255),Pn(e[2],255),Pn(e[3],255),Pn(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new wn(n,"rgb")},"func.hsl":t=>{const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[kn(e[1]),Pn(e[2],100),Pn(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new wn(n,"hsl")},"func.hsla":t=>{const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[kn(e[1]),Pn(e[2],100),Pn(e[3],100),Pn(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new wn(n,"hsl")},"hex.rgb":t=>{const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new wn([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");const n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new wn([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],"rgb"):null},"hex.rgba":t=>{const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new wn([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Ie(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");const n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new wn([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Ie(parseInt(n[4],16),0,255,0,1)],"rgb"):null}};function An(t){return Object.keys(Vn).reduce(((e,n)=>e||((0,Vn[n])(t)?n:null)),null)}const Rn=t=>{const e=An(t);return e?Vn[e](t):null};function Tn(t){return"func.hsla"===t||"func.rgba"===t||"hex.rgba"===t}function Ln(t){if("string"==typeof t){const e=Rn(t);if(e)return e}return wn.black()}function Sn(t){const e=Oe(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function Bn(t,e="#"){return`${e}${mn(t.getComponents("rgb")).map(Sn).join("")}`}function Fn(t,e="#"){const n=t.getComponents("rgb");return`${e}${[n[0],n[1],n[2],255*n[3]].map(Sn).join("")}`}function Dn(t){const e=Ce(0);return`rgb(${mn(t.getComponents("rgb")).map((t=>e(t))).join(", ")})`}function Un(t){const e=Ce(2),n=Ce(0);return`rgba(${t.getComponents("rgb").map(((t,i)=>(3===i?e:n)(t))).join(", ")})`}const In={"func.hsl":function(t){const e=[Ce(0),Pe,Pe];return`hsl(${mn(t.getComponents("hsl")).map(((t,n)=>e[n](t))).join(", ")})`},"func.hsla":function(t){const e=[Ce(0),Pe,Pe,Ce(2)];return`hsla(${t.getComponents("hsl").map(((t,n)=>e[n](t))).join(", ")})`},"func.rgb":Dn,"func.rgba":Un,"hex.rgb":Bn,"hex.rgba":Fn};function Nn(t){return In[t]}const On=v("apl");class jn{update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),n=new wn([e[0],e[1],e[2],0],"rgb"),i=new wn([e[0],e[1],e[2],255],"rgb"),r=["to right",Un(n),Un(i)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Un(t);const o=Ie(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(On()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(On("b")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(On("c")),n.appendChild(i),this.colorElem_=i;const r=t.createElement("div");r.classList.add(On("m")),this.element.appendChild(r),this.markerElem_=r;const o=t.createElement("div");o.classList.add(On("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}}class zn{handlePointerEvent_(t,e){if(!t.point)return;const n=t.point.x/t.bounds.width,i=this.value.rawValue,[r,o,s]=i.getComponents("hsv");this.value.setRawValue(new wn([r,o,s,n],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Le(En(!0),Be(t));if(0===e)return;const n=this.value.rawValue,[i,r,o,s]=n.getComponents("hsv");this.value.setRawValue(new wn([i,r,o,s+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Le(En(!0),Be(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new jn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}}const Kn=v("coltxt");class Hn{get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){z(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const n=t.createElement("div");n.classList.add(Kn("c")),n.appendChild(e.element),this.textsElem_.appendChild(n)}))}constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Kn());const n=t.createElement("div");n.classList.add(Kn("m")),this.modeElem_=function(t){const e=t.createElement("select");return e.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce(((e,n)=>{const i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}(t),this.modeElem_.classList.add(Kn("ms")),n.appendChild(this.modeSelectElement);const i=t.createElement("div");i.classList.add(Kn("mm")),i.appendChild(N(t,"dropdown")),n.appendChild(i),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(Kn("w")),this.element.appendChild(r),this.textsElem_=r,this.textViews_=e.textViews,this.applyTextViews_(),f(e.colorMode,(t=>{this.modeElem_.value=t}))}}const qn=Ce(0),Gn={rgb:()=>new Ht({min:0,max:255}),hsl:t=>new Ht(0===t?{min:0,max:360}:{min:0,max:100}),hsv:t=>new Ht(0===t?{min:0,max:360}:{min:0,max:100})};function Wn(t,e,n){return new He(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:En(!1),parser:e.parser,props:M.fromObject({draggingScale:1,formatter:qn}),value:P(0,{constraint:Gn[e.colorMode](n)}),viewProps:e.viewProps})}class Xn{createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},n=[Wn(t,e,0),Wn(t,e,1),Wn(t,e,2)];return n.forEach(((t,e)=>{Te({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue)[e],backward:(t,n)=>{const i=this.colorMode.rawValue,r=t.rawValue.getComponents(i);return r[e]=n.rawValue,new wn(fn(mn(r),r[3]),i)}})})),n}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=P(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new Hn(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}}const $n=v("hpl");class Yn{update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=Dn(new wn([e,100,100],"hsv"));const n=Ie(e,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add($n()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add($n("c")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add($n("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}}class Qn{handlePointerEvent_(t,e){if(!t.point)return;const n=Ie(t.point.x,0,t.bounds.width,0,360),i=this.value.rawValue,[,r,o,s]=i.getComponents("hsv");this.value.setRawValue(new wn([n,r,o,s],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Le(En(!1),Be(t));if(0===e)return;const n=this.value.rawValue,[i,r,o,s]=n.getComponents("hsv");this.value.setRawValue(new wn([i+e,r,o,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Le(En(!1),Be(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Yn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}}const Zn=v("svp");class Jn{update_(){const t=function(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,r=t.getImageData(0,0,n,i),o=r.data;for(let t=0;t<i;t++)for(let r=0;r<n;r++){const s=Ie(r,0,n,0,100),a=Ie(t,0,i,100,0),l=vn(e[0],s,a),u=4*(t*n+r);o[u]=l[0],o[u+1]=l[1],o[u+2]=l[2],o[u+3]=255}t.putImageData(r,0,0);const s=Ie(e[1],0,100,0,100);this.markerElem_.style.left=`${s}%`;const a=Ie(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Zn()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("canvas");n.height=64,n.width=64,n.classList.add(Zn("c")),this.element.appendChild(n),this.canvasElement=n;const i=t.createElement("div");i.classList.add(Zn("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}}class ti{handlePointerEvent_(t,e){if(!t.point)return;const n=Ie(t.point.x,0,t.bounds.width,0,100),i=Ie(t.point.y,0,t.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new wn([r,n,i,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Fe(t.key)&&t.preventDefault();const[e,n,i,r]=this.value.rawValue.getComponents("hsv"),o=En(!1),s=Le(o,Be(t)),a=Le(o,Se(t));0===s&&0===a||this.value.setRawValue(new wn([e,n+s,i+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=En(!1),n=Le(e,Be(t)),i=Le(e,Se(t));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Jn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}}class ei{get textController(){return this.textC_}constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Qn(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new ti(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new zn(t,{value:this.value,viewProps:this.viewProps}),text:new He(t,{parser:we,baseStep:.1,props:M.fromObject({draggingScale:.01,formatter:Ce(2)}),value:P(0,{constraint:new Ht({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Te({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const n=t.rawValue.getComponents();return n[3]=e.rawValue,new wn(n,t.rawValue.mode)}}),this.textC_=new Xn(t,{parser:we,value:this.value,viewProps:this.viewProps}),this.view=new yn(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}}const ni=v("colsw");class ii{update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Fn(t)}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(ni()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(ni("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=t.createElement("button");i.classList.add(ni("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}}class ri{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ii(t,{value:this.value,viewProps:this.viewProps})}}class oi{get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=K(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!D(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=Y.create(e.expanded),this.swatchC_=new ri(t,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new te(t,{parser:e.parser,props:M.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new dn(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new Qt(t,{viewProps:this.viewProps}):null;const i=new ei(t,{supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Te({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}}function si(t){return wn.isColorObject(t)?wn.fromObject(t):wn.black()}function ai(t){return mn(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function li(t){return t.getComponents("rgb").reduce(((t,e,n)=>t<<8|255&Math.floor(3===n?255*e:e)),0)>>>0}function ui(t){return"number"!=typeof t?wn.black():new wn([(e=t)>>16&255,e>>8&255,255&e],"rgb");var e}function ci(t){return"number"!=typeof t?wn.black():new wn([(e=t)>>24&255,e>>16&255,e>>8&255,Ie(255&e,0,255,0,1)],"rgb");var e}function hi(t,e){const n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function pi(t,e){const n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function di(t){return"alpha"in t&&!0===t.alpha}function vi(t){return t?t=>Fn(t,"0x"):t=>Bn(t,"0x")}const mi={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;if(!("view"in e))return null;if("color"!==e.view)return null;const n=Cn(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>di(t.params)?ci:ui,equals:wn.equals,writer:t=>function(t){const e=t?li:ai;return(t,n)=>{Qe(t,e(n))}}(di(t.params))},controller:t=>{const e=di(t.params),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new oi(t.document,{expanded:null!=n&&n,formatter:vi(e),parser:Rn,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}},fi={id:"input-color-object",type:"input",accept:(t,e)=>{if(!wn.isColorObject(t))return null;const n=Cn(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>si,equals:wn.equals,writer:t=>{return e=t.initialValue,wn.isRgbaColorObject(e)?hi:pi;var e}},controller:t=>{const e=wn.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0,r=e?Fn:Bn;return new oi(t.document,{expanded:null!=n&&n,formatter:r,parser:Rn,pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}},bi={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;if(!An(t))return null;const n=Cn(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>Ln,equals:wn.equals,writer:t=>{const e=An(t.initialValue);if(!e)throw u.shouldNeverHappen();return function(t){const e=Nn(t);return(t,n)=>{Qe(t,e(n))}}(e)}},controller:t=>{const e=An(t.initialValue);if(!e)throw u.shouldNeverHappen();const n=Nn(e),i="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new oi(t.document,{expanded:null!=i&&i,formatter:n,parser:Rn,pickerLayout:null!=r?r:"popup",supportsAlpha:Tn(e),value:t.value,viewProps:t.viewProps})}};class _i{constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,i;return null!==(i=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(e)}constructor(t){this.components=t.components,this.asm_=t.assembly}}const gi=v("pndtxt");class wi{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(gi()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(gi("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}class xi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,i)=>function(t,e,n){return new He(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:P(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}(t,e,i))),this.acs_.forEach(((t,n)=>{Te({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,i)=>{const r=e.assembly.toComponents(t.rawValue);return r[n]=i.rawValue,e.assembly.fromComponents(r)}})})),this.view=new wi(t,{textViews:this.acs_.map((t=>t.view))})}}function yi(t){const e=[],n=function(t){return"step"in t&&!s(t.step)?new qt(t.step):null}(t);n&&e.push(n);const i=function(t){return"max"in t&&!s(t.max)||"min"in t&&!s(t.min)?new Ht({max:t.max,min:t.min}):null}(t);i&&e.push(i);const r=nn(t.options);return r&&e.push(r),new jt(e)}function Ci(t){const[e,n]=function(t){const e=t?zt(t,Ht):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}(t);return[null!=e?e:0,null!=n?n:100]}const Ei={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const n=A,i=R(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(Ze),step:n.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:t=>xe,constraint:t=>yi(t.params),writer:t=>Qe},controller:t=>{var e,n;const i=t.value,r=t.constraint;if(r&&zt(r,Kt))return new Xt(t.document,{props:M.fromObject({options:null!==(e=rn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps});const o=null!==(n="format"in t.params?t.params.format:void 0)&&void 0!==n?n:Ce(on(r,i.rawValue));if(r&&zt(r,Ht)){const[e,n]=Ci(r);return new Ye(t.document,{baseStep:sn(r),parser:we,sliderProps:M.fromObject({maxValue:n,minValue:e}),textProps:M.fromObject({draggingScale:an(r,i.rawValue),formatter:o}),value:i,viewProps:t.viewProps})}return new He(t.document,{baseStep:sn(r),parser:we,props:M.fromObject({draggingScale:an(r,i.rawValue),formatter:o}),value:i,viewProps:t.viewProps})}};class Pi{getComponents(){return[this.x,this.y]}static isObject(t){if(s(t))return!1;const e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}constructor(t=0,e=0){this.x=t,this.y=e}}const Mi={toComponents:t=>t.getComponents(),fromComponents:t=>new Pi(...t)},ki=v("p2d");class Vi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ki()),e.viewProps.bindClassModifiers(this.element),f(e.expanded,_(this.element,ki(void 0,"expanded")));const n=t.createElement("div");n.classList.add(ki("h")),this.element.appendChild(n);const i=t.createElement("button");i.classList.add(ki("b")),i.appendChild(N(t,"p2dpad")),e.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const r=t.createElement("div");if(r.classList.add(ki("t")),n.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(ki("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Ai=v("p2dp");class Ri{get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),n=this.maxValue_,i=Ie(t,-n,+n,0,100),r=Ie(e,-n,+n,0,100),o=this.invertsY_?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Ai()),"popup"===e.layout&&this.element.classList.add(Ai(void 0,"p"));const n=t.createElement("div");n.classList.add(Ai("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=t.createElementNS(B,"svg");i.classList.add(Ai("g")),this.padElement.appendChild(i),this.svgElem_=i;const r=t.createElementNS(B,"line");r.classList.add(Ai("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=t.createElementNS(B,"line");o.classList.add(Ai("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const s=t.createElementNS(B,"line");s.classList.add(Ai("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;const a=t.createElement("div");a.classList.add(Ai("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}}function Ti(t,e,n){return[Le(e[0],Be(t)),Le(e[1],Se(t))*(n?1:-1)]}class Li{handlePointerEvent_(t,e){if(!t.point)return;const n=this.maxValue_,i=Ie(t.point.x,0,t.bounds.width,-n,+n),r=Ie(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new Pi(i,r),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Fe(t.key)&&t.preventDefault();const[e,n]=Ti(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(new Pi(this.value.rawValue.x+e,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,n]=Ti(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new Ri(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}}class Si{onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=K(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!D(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}constructor(t,e){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=Y.create(e.expanded),this.popC_="popup"===e.pickerLayout?new Qt(t,{viewProps:this.viewProps}):null;const r=new Li(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=r,this.textC_=new xi(t,{assembly:Mi,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Vi(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Te({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}}function Bi(t){return Pi.isObject(t)?new Pi(t.x,t.y):new Pi}function Fi(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function Di(t){if(!t)return;const e=[];return s(t.step)||e.push(new qt(t.step)),s(t.max)&&s(t.min)||e.push(new Ht({max:t.max,min:t.min})),new jt(e)}function Ui(t,e){const n=t&&zt(t,Ht);if(n)return Math.max(Math.abs(n.minValue||0),Math.abs(n.maxValue||0));const i=sn(t);return Math.max(10*Math.abs(i),10*Math.abs(e))}function Ii(t,e){const n=e instanceof _i?e.components[0]:void 0,i=e instanceof _i?e.components[1]:void 0,r=Ui(n,t.x),o=Ui(i,t.y);return Math.max(r,o)}function Ni(t,e){return{baseStep:sn(e),constraint:e,textProps:M.fromObject({draggingScale:an(e,t),formatter:Ce(on(e,t))})}}function Oi(t){if(!("y"in t))return!1;const e=t.y;return!!e&&"inverted"in e&&!!e.inverted}const ji={id:"input-point2d",type:"input",accept:(t,e)=>{if(!Pi.isObject(t))return null;const n=A,i=R(e,{expanded:n.optional.boolean,picker:n.optional.custom(Je),x:n.optional.custom(tn),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Bi,constraint:t=>{return e=t.params,new _i({assembly:Mi,components:[Di("x"in e?e.x:void 0),Di("y"in e?e.y:void 0)]});var e},equals:Pi.equals,writer:t=>Fi},controller:t=>{const e=t.document,n=t.value,i=t.constraint;if(!(i instanceof _i))throw u.shouldNeverHappen();const r="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new Si(e,{axes:[Ni(n.rawValue.x,i.components[0]),Ni(n.rawValue.y,i.components[1])],expanded:null!=r&&r,invertsY:Oi(t.params),maxValue:Ii(n.rawValue,i),parser:we,pickerLayout:null!=o?o:"popup",value:n,viewProps:t.viewProps})}};class zi{getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(s(t))return!1;const e=t.x,n=t.y,i=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}}const Ki={toComponents:t=>t.getComponents(),fromComponents:t=>new zi(...t)};function Hi(t){return zi.isObject(t)?new zi(t.x,t.y,t.z):new zi}function qi(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function Gi(t){if(!t)return;const e=[];return s(t.step)||e.push(new qt(t.step)),s(t.max)&&s(t.min)||e.push(new Ht({max:t.max,min:t.min})),new jt(e)}function Wi(t,e){return{baseStep:sn(e),constraint:e,textProps:M.fromObject({draggingScale:an(e,t),formatter:Ce(on(e,t))})}}const Xi={id:"input-point3d",type:"input",accept:(t,e)=>{if(!zi.isObject(t))return null;const n=A,i=R(e,{x:n.optional.custom(tn),y:n.optional.custom(tn),z:n.optional.custom(tn)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Hi,constraint:t=>{return e=t.params,new _i({assembly:Ki,components:[Gi("x"in e?e.x:void 0),Gi("y"in e?e.y:void 0),Gi("z"in e?e.z:void 0)]});var e},equals:zi.equals,writer:t=>qi},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof _i))throw u.shouldNeverHappen();return new xi(t.document,{assembly:Ki,axes:[Wi(e.rawValue.x,n.components[0]),Wi(e.rawValue.y,n.components[1]),Wi(e.rawValue.z,n.components[2])],parser:we,value:e,viewProps:t.viewProps})}};class $i{getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(s(t))return!1;const e=t.x,n=t.y,i=t.z,r=t.w;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i&&"number"==typeof r}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.z=n,this.w=i}}const Yi={toComponents:t=>t.getComponents(),fromComponents:t=>new $i(...t)};function Qi(t){return $i.isObject(t)?new $i(t.x,t.y,t.z,t.w):new $i}function Zi(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function Ji(t){if(!t)return;const e=[];return s(t.step)||e.push(new qt(t.step)),s(t.max)&&s(t.min)||e.push(new Ht({max:t.max,min:t.min})),new jt(e)}const tr={id:"input-point4d",type:"input",accept:(t,e)=>{if(!$i.isObject(t))return null;const n=A,i=R(e,{x:n.optional.custom(tn),y:n.optional.custom(tn),z:n.optional.custom(tn),w:n.optional.custom(tn)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Qi,constraint:t=>{return e=t.params,new _i({assembly:Yi,components:[Ji("x"in e?e.x:void 0),Ji("y"in e?e.y:void 0),Ji("z"in e?e.z:void 0),Ji("w"in e?e.w:void 0)]});var e},equals:$i.equals,writer:t=>Zi},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof _i))throw u.shouldNeverHappen();return new xi(t.document,{assembly:Yi,axes:e.rawValue.getComponents().map(((t,e)=>{return i=t,{baseStep:sn(r=n.components[e]),constraint:r,textProps:M.fromObject({draggingScale:an(r,i),formatter:Ce(on(r,i))})};var i,r})),parser:we,value:e,viewProps:t.viewProps})}},er={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const n=R(e,{options:A.optional.custom(Ze)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Me,constraint:t=>function(t){const e=[],n=nn(t.options);return n&&e.push(n),new jt(e)}(t.params),writer:t=>Qe},controller:t=>{var e;const n=t.document,i=t.value,r=t.constraint;return r&&zt(r,Kt)?new Xt(n,{props:M.fromObject({options:null!==(e=rn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new te(n,{parser:t=>t,props:M.fromObject({formatter:ke}),value:i,viewProps:t.viewProps})}},nr={defaultInterval:200,defaultLineCount:3},ir=v("mll");class rr{update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,n=[];this.value.rawValue.forEach((t=>{void 0!==t&&n.push(this.formatter_(t))})),t.textContent=n.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(ir()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("textarea");n.classList.add(ir("i")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,n.readOnly=!0,e.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}}class or{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new rr(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const sr=v("sgl");class ar{update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(sr()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(sr("i")),n.readOnly=!0,n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}}class lr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ar(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const ur={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=R(e,{lineCount:A.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>ee},controller:t=>{var e;return 1===t.value.rawValue.length?new lr(t.document,{formatter:ne,value:t.value,viewProps:t.viewProps}):new or(t.document,{formatter:ne,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:nr.defaultLineCount,value:t.value,viewProps:t.viewProps})}};class cr{get index(){return this.index_}set index(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}constructor(){this.emitter=new p,this.index_=-1}}const hr=v("grl");class pr{get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,i=this.maxValue_,r=[];this.value.rawValue.forEach(((o,s)=>{if(void 0===o)return;const a=Ie(s,0,e,0,t.width),l=Ie(o,n,i,t.height,0);r.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,s=this.value.rawValue[this.cursor_.index];if(void 0===s)return void o.classList.remove(hr("t","a"));const a=Ie(this.cursor_.index,0,e,0,t.width),l=Ie(s,n,i,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(s)}`,o.classList.contains(hr("t","a"))||(o.classList.add(hr("t","a"),hr("t","in")),F(o),o.classList.remove(hr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(hr()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(B,"svg");n.classList.add(hr("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const i=t.createElementNS(B,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const r=t.createElement("div");r.classList.add(hr("t"),v("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}}class dr{onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Ie(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.index=Math.floor(Ie(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.cursor_=new cr,this.view=new pr(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:this.viewProps}),D(t)){const t=new Ue(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}}function vr(t){return"format"in t&&!s(t.format)?t.format:Ce(2)}function mr(t){return"view"in t&&"graph"===t.view}const fr={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const n=A,i=R(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:t=>mr(t)?64:1,reader:t=>xe},controller:t=>mr(t.params)?function(t){var e,n,i;return new dr(t.document,{formatter:vr(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:nr.defaultLineCount,maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in t.params?t.params.min:null)&&void 0!==i?i:0,value:t.value,viewProps:t.viewProps})}(t):function(t){var e;return 1===t.value.rawValue.length?new lr(t.document,{formatter:vr(t.params),value:t.value,viewProps:t.viewProps}):new or(t.document,{formatter:vr(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:nr.defaultLineCount,value:t.value,viewProps:t.viewProps})}(t)},br={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const n=A,i=R(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Me},controller:t=>{var e;const n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new or(t.document,{formatter:ke,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:nr.defaultLineCount,value:n,viewProps:t.viewProps}):new lr(t.document,{formatter:ke,value:n,viewProps:t.viewProps})}};class _r{read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new p,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}}class gr{dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=function(t,e){const n=[...Re(t),e];return n.length>t.length?n.splice(0,n.length-t.length):Ve(n,t.length),n}(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}onTick_(t){this.read()}constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new p,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}}function wr(t,e){return 0===e?new Nt:new Ot(t,null!=e?e:nr.defaultInterval)}class xr{getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,n){if(s(e.read()))throw new u({context:{key:e.key},type:"nomatchingcontroller"});const i=this.pluginsMap_.inputs.reduce(((i,r)=>i||function(t,e){const n=t.accept(e.target.read(),e.params);if(s(n))return null;const i=A,r={target:e.target,initialValue:n.initialValue,params:n.params},o=t.binding.reader(r),a=t.binding.constraint?t.binding.constraint(r):void 0,l=P(o(n.initialValue),{constraint:a,equals:t.binding.equals}),u=new _r({reader:o,target:e.target,value:l,writer:t.binding.writer(r)}),c=i.optional.boolean(e.params.disabled).value,h=i.optional.boolean(e.params.hidden).value,p=t.controller({constraint:a,document:e.document,initialValue:n.initialValue,params:n.params,value:u.value,viewProps:Vt.create({disabled:c,hidden:h})}),d=i.optional.string(e.params.label).value;return new nt(e.document,{binding:u,blade:$(),props:M.fromObject({label:d||e.target.key}),valueController:p})}(r,{document:t,target:e,params:n})),null);if(i)return i;throw new u({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,n){const i=this.pluginsMap_.monitors.reduce(((i,r)=>i||function(t,e){var n,i,r;const o=A,a=t.accept(e.target.read(),e.params);if(s(a))return null;const l={target:e.target,initialValue:a.initialValue,params:a.params},u=t.binding.reader(l),c=null!==(i=null!==(n=o.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(a.params))&&void 0!==i?i:1,h=o.optional.number(e.params.interval).value,p=new gr({reader:u,target:e.target,ticker:wr(e.document,h),value:Ae(c)}),d=o.optional.boolean(e.params.disabled).value,v=o.optional.boolean(e.params.hidden).value,m=t.controller({document:e.document,params:a.params,value:p.value,viewProps:Vt.create({disabled:d,hidden:v})}),f=null!==(r=o.optional.string(e.params.label).value)&&void 0!==r?r:e.target.key;return new rt(e.document,{binding:p,blade:$(),props:M.fromObject({label:f}),valueController:m})}(r,{document:t,params:n,target:e})),null);if(i)return i;throw new u({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const n=this.pluginsMap_.blades.reduce(((n,i)=>n||function(t,e){const n=t.accept(e.params);if(!n)return null;const i=A.optional.boolean(e.params.disabled).value,r=A.optional.boolean(e.params.hidden).value;return t.controller({blade:$(),document:e.document,params:Object.assign(Object.assign({},n.params),{disabled:i,hidden:r}),viewProps:Vt.create({disabled:i,hidden:r})})}(i,{document:t,params:e})),null);if(!n)throw new u({type:"nomatchingview",context:{params:e}});return n}createBladeApi(t){if(t instanceof nt)return new et(t);if(t instanceof rt)return new it(t);if(t instanceof mt)return new lt(t,this);const e=this.pluginsMap_.blades.reduce(((e,n)=>e||n.api({controller:t,pool:this})),null);if(!e)throw u.shouldNeverHappen();return e}constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}}class yr extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t){super(t),this.emitter_=new p,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new i(this,t.rawValue)})}))}}class Cr extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t){super(t),this.emitter_=new p,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new i(this,t.rawValue)})}))}}class Er extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t){super(t),this.emitter_=new p,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new i(this,t.rawValue)})}))}}const Pr={id:"list",type:"blade",accept(t){const e=A,n=R(t,{options:e.required.custom(Ze),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller(t){const e=new Xt(t.document,{props:M.fromObject({options:en(t.params.options)}),value:P(t.params.value),viewProps:t.viewProps});return new wt(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:e})},api:t=>t.controller instanceof wt&&t.controller.valueController instanceof Xt?new yr(t.controller):null};class Mr extends ut{get element(){return this.controller_.view.element}importPreset(t){!function(t,e){t.forEach((t=>{const n=e[t.presetKey];void 0!==n&&t.write(n)}))}(this.controller_.rackController.rack.find(nt).map((t=>t.binding.target)),t),this.refresh()}exportPreset(){return function(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}(this.controller_.rackController.rack.find(nt).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(nt).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(rt).forEach((t=>{t.binding.read()}))}constructor(t,e){super(t,e)}}class kr extends _t{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Vr={id:"slider",type:"blade",accept(t){const e=A,n=R(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller(t){var e,n;const i=null!==(e=t.params.value)&&void 0!==e?e:0,r=new Ye(t.document,{baseStep:1,parser:we,sliderProps:M.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:M.fromObject({draggingScale:an(void 0,i),formatter:null!==(n=t.params.format)&&void 0!==n?n:ye}),value:P(i),viewProps:t.viewProps});return new wt(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:r})},api:t=>t.controller instanceof wt&&t.controller.valueController instanceof Ye?new Cr(t.controller):null},Ar={id:"text",type:"blade",accept(t){const e=A,n=R(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller(t){var e;const n=new te(t.document,{parser:t.params.parse,props:M.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:P(t.params.value),viewProps:t.viewProps});return new wt(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof wt&&t.controller.valueController instanceof te?new Er(t.controller):null};function Rr(t,e,n){if(t.querySelector(`style[data-tp-style=${e}]`))return;const i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}const Tr=new class{toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}constructor(t){const[e,n]=t.split("-"),i=e.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}}("3.0.7");t.BladeApi=e,t.ButtonApi=h,t.FolderApi=ut,t.InputBindingApi=et,t.ListApi=yr,t.MonitorBindingApi=it,t.Pane=class extends Mr{get document(){if(!this.doc_)throw u.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw u.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&Rr(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){Rr(this.document,"default",".tp-lstv_s,.tp-btnv_b,.tp-p2dv_b,.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i,.tp-grlv_g,.tp-sglv_i,.tp-mllv_i,.tp-fldv_b,.tp-rotv_b,.tp-ckbv_i,.tp-coltxtv_ms,.tp-tbiv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-lstv_s,.tp-btnv_b,.tp-p2dv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-lstv_s:hover,.tp-btnv_b:hover,.tp-p2dv_b:hover{background-color:var(--btn-bg-h)}.tp-lstv_s:focus,.tp-btnv_b:focus,.tp-p2dv_b:focus{background-color:var(--btn-bg-f)}.tp-lstv_s:active,.tp-btnv_b:active,.tp-p2dv_b:active{background-color:var(--btn-bg-a)}.tp-lstv_s:disabled,.tp-btnv_b:disabled,.tp-p2dv_b:disabled{opacity:0.5}.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-colswv_sw:hover,.tp-p2dpv_p:hover,.tp-txtv_i:hover{background-color:var(--in-bg-h)}.tp-colswv_sw:focus,.tp-p2dpv_p:focus,.tp-txtv_i:focus{background-color:var(--in-bg-f)}.tp-colswv_sw:active,.tp-p2dpv_p:active,.tp-txtv_i:active{background-color:var(--in-bg-a)}.tp-colswv_sw:disabled,.tp-p2dpv_p:disabled,.tp-txtv_i:disabled{opacity:0.5}.tp-grlv_g,.tp-sglv_i,.tp-mllv_i{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);width:100%}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono,Source Code Pro,Menlo,Courier,monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #2f3137);--bs-sh: var(--tp-base-shadow-color, rgba(0,0,0,0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #2f3137);--cnt-bg: var(--tp-container-background-color, rgba(187,188,196,0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187,188,196,0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187,188,196,0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187,188,196,0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187,188,196,0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187,188,196,0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187,188,196,0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187,188,196,0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187,188,196,0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0,0,0,0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187,188,196,0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(0,0,0,0.2))}.tp-fldv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-rotv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1 * var(--cnt-v-p))}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-rotv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-fldv_c>.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv{margin-left:4px}.tp-fldv_c>.tp-fldv>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c .tp-fldv>.tp-fldv_c,.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-tabv>.tp-tabv_i,.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-fldv_c .tp-tabv>.tp-tabv_c,.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_b,.tp-rotv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-fldv_b:hover,.tp-rotv_b:hover{background-color:var(--cnt-bg-h)}.tp-fldv_b:focus,.tp-rotv_b:focus{background-color:var(--cnt-bg-f)}.tp-fldv_b:active,.tp-rotv_b:active{background-color:var(--cnt-bg-a)}.tp-fldv_b:disabled,.tp-rotv_b:disabled{opacity:0.5}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:'';display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px) / 2 - 2px);margin:auto;opacity:0.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{transform:none}.tp-fldv_c,.tp-rotv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c,.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c{display:none}.tp-fldv.tp-fldv-expanded>.tp-fldv_c,.tp-rotv.tp-rotv-expanded .tp-rotv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-coltxtv_m,.tp-lstv{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-coltxtv_mm,.tp-lstv_m{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-coltxtv_mm svg,.tp-lstv_m svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-coltxtv_mm svg path,.tp-lstv_m svg path{fill:currentColor}.tp-coltxtv_w,.tp-pndtxtv{display:flex}.tp-coltxtv_c,.tp-pndtxtv_a{width:100%}.tp-coltxtv_c+.tp-coltxtv_c,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-pndtxtv_a{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:0.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:'';height:2px;left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us) * 4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0,0,0,0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,0.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,0.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br)}.tp-colswv.tp-v-disabled{opacity:0.5}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left 0.05s, top 0.05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:0.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:0.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:0.5}.tp-mllv_i{display:block;height:calc(var(--bld-us) * 3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:0.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:0.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:'';display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:0.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:0.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:0.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:0.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:0.1;position:absolute;top:0;transition:border-radius 0.1s, height 0.1s, transform 0.1s, width 0.1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:'';font-size:0.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}"),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[Vr,Pr,It,Ar]})}constructor(t){var e;const n=t||{},i=null!==(e=n.document)&&void 0!==e?e:U(),r=function(){const t=new xr;return[ji,Xi,tr,er,Ei,bi,fi,mi,hn,ur,br,fr,W,gt,Pt,It].forEach((e=>{t.register(e)})),t}();super(new kr(i,{expanded:n.expanded,blade:$(),props:M.fromObject({title:n.title}),viewProps:Vt.create()}),r),this.pool_=r,this.containerElem_=n.container||function(t){const e=t.createElement("div");return e.classList.add(v("dfw")()),t.body&&t.body.appendChild(e),e}(i),this.containerElem_.appendChild(this.element),this.doc_=i,this.usesDefaultWrapper_=!n.container,this.setUpDefaultPlugins_()}},t.SeparatorApi=xt,t.SliderApi=Cr,t.TabApi=Bt,t.TabPageApi=St,t.TextApi=Er,t.TpChangeEvent=i,t.VERSION=Tr,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof r?i(r):"function"==typeof define&&define.amd?define(["exports"],i):i((n="undefined"!=typeof globalThis?globalThis:n||self).Tweakpane={});var u={};e(u,"create",(function(){return p})),e(u,"clone",(function(){return d})),e(u,"copy",(function(){return v})),e(u,"fromValues",(function(){return m})),e(u,"set",(function(){return f})),e(u,"identity",(function(){return b})),e(u,"transpose",(function(){return _})),e(u,"invert",(function(){return g})),e(u,"adjoint",(function(){return w})),e(u,"determinant",(function(){return x})),e(u,"multiply",(function(){return y})),e(u,"translate",(function(){return C})),e(u,"scale",(function(){return E})),e(u,"rotate",(function(){return P})),e(u,"rotateX",(function(){return M})),e(u,"rotateY",(function(){return k})),e(u,"rotateZ",(function(){return V})),e(u,"fromTranslation",(function(){return A})),e(u,"fromScaling",(function(){return R})),e(u,"fromRotation",(function(){return T})),e(u,"fromXRotation",(function(){return L})),e(u,"fromYRotation",(function(){return S})),e(u,"fromZRotation",(function(){return B})),e(u,"fromRotationTranslation",(function(){return F})),e(u,"fromQuat2",(function(){return D})),e(u,"getTranslation",(function(){return U})),e(u,"getScaling",(function(){return I})),e(u,"getRotation",(function(){return N})),e(u,"fromRotationTranslationScale",(function(){return O})),e(u,"fromRotationTranslationScaleOrigin",(function(){return j})),e(u,"fromQuat",(function(){return z})),e(u,"frustum",(function(){return K})),e(u,"perspectiveNO",(function(){return H})),e(u,"perspective",(function(){return q})),e(u,"perspectiveZO",(function(){return G})),e(u,"perspectiveFromFieldOfView",(function(){return W})),e(u,"orthoNO",(function(){return X})),e(u,"ortho",(function(){return $})),e(u,"orthoZO",(function(){return Y})),e(u,"lookAt",(function(){return Q})),e(u,"targetTo",(function(){return Z})),e(u,"str",(function(){return J})),e(u,"frob",(function(){return tt})),e(u,"add",(function(){return et})),e(u,"subtract",(function(){return nt})),e(u,"multiplyScalar",(function(){return it})),e(u,"multiplyScalarAndAdd",(function(){return rt})),e(u,"exactEquals",(function(){return ot})),e(u,"equals",(function(){return st})),e(u,"mul",(function(){return at})),e(u,"sub",(function(){return lt}));var c="undefined"!=typeof Float32Array?Float32Array:Array,h=Math.random;Math.PI;function p(){var t=new c(16);return c!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function d(t){var e=new c(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function v(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function m(t,e,n,i,r,o,s,a,l,u,h,p,d,v,m,f){var b=new c(16);return b[0]=t,b[1]=e,b[2]=n,b[3]=i,b[4]=r,b[5]=o,b[6]=s,b[7]=a,b[8]=l,b[9]=u,b[10]=h,b[11]=p,b[12]=d,b[13]=v,b[14]=m,b[15]=f,b}function f(t,e,n,i,r,o,s,a,l,u,c,h,p,d,v,m,f){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=p,t[12]=d,t[13]=v,t[14]=m,t[15]=f,t}function b(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function g(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],f=e[14],b=e[15],_=n*a-i*s,g=n*l-r*s,w=n*u-o*s,x=i*l-r*a,y=i*u-o*a,C=r*u-o*l,E=c*m-h*v,P=c*f-p*v,M=c*b-d*v,k=h*f-p*m,V=h*b-d*m,A=p*b-d*f,R=_*A-g*V+w*k+x*M-y*P+C*E;return R?(R=1/R,t[0]=(a*A-l*V+u*k)*R,t[1]=(r*V-i*A-o*k)*R,t[2]=(m*C-f*y+b*x)*R,t[3]=(p*y-h*C-d*x)*R,t[4]=(l*M-s*A-u*P)*R,t[5]=(n*A-r*M+o*P)*R,t[6]=(f*w-v*C-b*g)*R,t[7]=(c*C-p*w+d*g)*R,t[8]=(s*V-a*M+u*E)*R,t[9]=(i*M-n*V-o*E)*R,t[10]=(v*y-m*w+b*_)*R,t[11]=(h*w-c*y-d*_)*R,t[12]=(a*P-s*k-l*E)*R,t[13]=(n*k-i*P+r*E)*R,t[14]=(m*g-v*x-f*_)*R,t[15]=(c*x-h*g+p*_)*R,t):null}function w(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],f=e[14],b=e[15];return t[0]=a*(p*b-d*f)-h*(l*b-u*f)+m*(l*d-u*p),t[1]=-(i*(p*b-d*f)-h*(r*b-o*f)+m*(r*d-o*p)),t[2]=i*(l*b-u*f)-a*(r*b-o*f)+m*(r*u-o*l),t[3]=-(i*(l*d-u*p)-a*(r*d-o*p)+h*(r*u-o*l)),t[4]=-(s*(p*b-d*f)-c*(l*b-u*f)+v*(l*d-u*p)),t[5]=n*(p*b-d*f)-c*(r*b-o*f)+v*(r*d-o*p),t[6]=-(n*(l*b-u*f)-s*(r*b-o*f)+v*(r*u-o*l)),t[7]=n*(l*d-u*p)-s*(r*d-o*p)+c*(r*u-o*l),t[8]=s*(h*b-d*m)-c*(a*b-u*m)+v*(a*d-u*h),t[9]=-(n*(h*b-d*m)-c*(i*b-o*m)+v*(i*d-o*h)),t[10]=n*(a*b-u*m)-s*(i*b-o*m)+v*(i*u-o*a),t[11]=-(n*(a*d-u*h)-s*(i*d-o*h)+c*(i*u-o*a)),t[12]=-(s*(h*f-p*m)-c*(a*f-l*m)+v*(a*p-l*h)),t[13]=n*(h*f-p*m)-c*(i*f-r*m)+v*(i*p-r*h),t[14]=-(n*(a*f-l*m)-s*(i*f-r*m)+v*(i*l-r*a)),t[15]=n*(a*p-l*h)-s*(i*p-r*h)+c*(i*l-r*a),t}function x(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],f=t[15];return(e*s-n*o)*(h*f-p*m)-(e*a-i*o)*(c*f-p*v)+(e*l-r*o)*(c*m-h*v)+(n*a-i*s)*(u*f-p*d)-(n*l-r*s)*(u*m-h*d)+(i*l-r*a)*(u*v-c*d)}function y(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],v=e[11],m=e[12],f=e[13],b=e[14],_=e[15],g=n[0],w=n[1],x=n[2],y=n[3];return t[0]=g*i+w*a+x*h+y*m,t[1]=g*r+w*l+x*p+y*f,t[2]=g*o+w*u+x*d+y*b,t[3]=g*s+w*c+x*v+y*_,g=n[4],w=n[5],x=n[6],y=n[7],t[4]=g*i+w*a+x*h+y*m,t[5]=g*r+w*l+x*p+y*f,t[6]=g*o+w*u+x*d+y*b,t[7]=g*s+w*c+x*v+y*_,g=n[8],w=n[9],x=n[10],y=n[11],t[8]=g*i+w*a+x*h+y*m,t[9]=g*r+w*l+x*p+y*f,t[10]=g*o+w*u+x*d+y*b,t[11]=g*s+w*c+x*v+y*_,g=n[12],w=n[13],x=n[14],y=n[15],t[12]=g*i+w*a+x*h+y*m,t[13]=g*r+w*l+x*p+y*f,t[14]=g*o+w*u+x*d+y*b,t[15]=g*s+w*c+x*v+y*_,t}function C(t,e,n){var i,r,o,s,a,l,u,c,h,p,d,v,m=n[0],f=n[1],b=n[2];return e===t?(t[12]=e[0]*m+e[4]*f+e[8]*b+e[12],t[13]=e[1]*m+e[5]*f+e[9]*b+e[13],t[14]=e[2]*m+e[6]*f+e[10]*b+e[14],t[15]=e[3]*m+e[7]*f+e[11]*b+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],v=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=d,t[11]=v,t[12]=i*m+a*f+h*b+e[12],t[13]=r*m+l*f+p*b+e[13],t[14]=o*m+u*f+d*b+e[14],t[15]=s*m+c*f+v*b+e[15]),t}function E(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function P(t,e,n,i){var r,o,s,a,l,u,c,h,p,d,v,m,f,b,_,g,w,x,y,C,E,P,M,k,V=i[0],A=i[1],R=i[2],T=Math.hypot(V,A,R);return T<1e-6?null:(V*=T=1/T,A*=T,R*=T,r=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],p=e[5],d=e[6],v=e[7],m=e[8],f=e[9],b=e[10],_=e[11],g=V*V*s+o,w=A*V*s+R*r,x=R*V*s-A*r,y=V*A*s-R*r,C=A*A*s+o,E=R*A*s+V*r,P=V*R*s+A*r,M=A*R*s-V*r,k=R*R*s+o,t[0]=a*g+h*w+m*x,t[1]=l*g+p*w+f*x,t[2]=u*g+d*w+b*x,t[3]=c*g+v*w+_*x,t[4]=a*y+h*C+m*E,t[5]=l*y+p*C+f*E,t[6]=u*y+d*C+b*E,t[7]=c*y+v*C+_*E,t[8]=a*P+h*M+m*k,t[9]=l*P+p*M+f*k,t[10]=u*P+d*M+b*k,t[11]=c*P+v*M+_*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function M(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=s*r+c*i,t[6]=a*r+h*i,t[7]=l*r+p*i,t[8]=u*r-o*i,t[9]=c*r-s*i,t[10]=h*r-a*i,t[11]=p*r-l*i,t}function k(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-u*i,t[1]=s*r-c*i,t[2]=a*r-h*i,t[3]=l*r-p*i,t[8]=o*i+u*r,t[9]=s*i+c*r,t[10]=a*i+h*r,t[11]=l*i+p*r,t}function V(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=s*r+c*i,t[2]=a*r+h*i,t[3]=l*r+p*i,t[4]=u*r-o*i,t[5]=c*r-s*i,t[6]=h*r-a*i,t[7]=p*r-l*i,t}function A(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function R(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function T(t,e,n){var i,r,o,s=n[0],a=n[1],l=n[2],u=Math.hypot(s,a,l);return u<1e-6?null:(s*=u=1/u,a*=u,l*=u,i=Math.sin(e),o=1-(r=Math.cos(e)),t[0]=s*s*o+r,t[1]=a*s*o+l*i,t[2]=l*s*o-a*i,t[3]=0,t[4]=s*a*o-l*i,t[5]=a*a*o+r,t[6]=l*a*o+s*i,t[7]=0,t[8]=s*l*o+a*i,t[9]=a*l*o-s*i,t[10]=l*l*o+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function L(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function B(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function F(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=i+i,l=r+r,u=o+o,c=i*a,h=i*l,p=i*u,d=r*l,v=r*u,m=o*u,f=s*a,b=s*l,_=s*u;return t[0]=1-(d+m),t[1]=h+_,t[2]=p-b,t[3]=0,t[4]=h-_,t[5]=1-(c+m),t[6]=v+f,t[7]=0,t[8]=p+b,t[9]=v-f,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function D(t,e){var n=new c(3),i=-e[0],r=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],u=e[6],h=e[7],p=i*i+r*r+o*o+s*s;return p>0?(n[0]=2*(a*s+h*i+l*o-u*r)/p,n[1]=2*(l*s+h*r+u*i-a*o)/p,n[2]=2*(u*s+h*o+a*r-l*i)/p):(n[0]=2*(a*s+h*i+l*o-u*r),n[1]=2*(l*s+h*r+u*i-a*o),n[2]=2*(u*s+h*o+a*r-l*i)),F(t,e,n),t}function U(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function I(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],s=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(l,u,c),t}function N(t,e){var n=new c(3);I(n,e);var i=1/n[0],r=1/n[1],o=1/n[2],s=e[0]*i,a=e[1]*r,l=e[2]*o,u=e[4]*i,h=e[5]*r,p=e[6]*o,d=e[8]*i,v=e[9]*r,m=e[10]*o,f=s+h+m,b=0;return f>0?(b=2*Math.sqrt(f+1),t[3]=.25*b,t[0]=(p-v)/b,t[1]=(d-l)/b,t[2]=(a-u)/b):s>h&&s>m?(b=2*Math.sqrt(1+s-h-m),t[3]=(p-v)/b,t[0]=.25*b,t[1]=(a+u)/b,t[2]=(d+l)/b):h>m?(b=2*Math.sqrt(1+h-s-m),t[3]=(d-l)/b,t[0]=(a+u)/b,t[1]=.25*b,t[2]=(p+v)/b):(b=2*Math.sqrt(1+m-s-h),t[3]=(a-u)/b,t[0]=(d+l)/b,t[1]=(p+v)/b,t[2]=.25*b),t}function O(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3],l=r+r,u=o+o,c=s+s,h=r*l,p=r*u,d=r*c,v=o*u,m=o*c,f=s*c,b=a*l,_=a*u,g=a*c,w=i[0],x=i[1],y=i[2];return t[0]=(1-(v+f))*w,t[1]=(p+g)*w,t[2]=(d-_)*w,t[3]=0,t[4]=(p-g)*x,t[5]=(1-(h+f))*x,t[6]=(m+b)*x,t[7]=0,t[8]=(d+_)*y,t[9]=(m-b)*y,t[10]=(1-(h+v))*y,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function j(t,e,n,i,r){var o=e[0],s=e[1],a=e[2],l=e[3],u=o+o,c=s+s,h=a+a,p=o*u,d=o*c,v=o*h,m=s*c,f=s*h,b=a*h,_=l*u,g=l*c,w=l*h,x=i[0],y=i[1],C=i[2],E=r[0],P=r[1],M=r[2],k=(1-(m+b))*x,V=(d+w)*x,A=(v-g)*x,R=(d-w)*y,T=(1-(p+b))*y,L=(f+_)*y,S=(v+g)*C,B=(f-_)*C,F=(1-(p+m))*C;return t[0]=k,t[1]=V,t[2]=A,t[3]=0,t[4]=R,t[5]=T,t[6]=L,t[7]=0,t[8]=S,t[9]=B,t[10]=F,t[11]=0,t[12]=n[0]+E-(k*E+R*P+S*M),t[13]=n[1]+P-(V*E+T*P+B*M),t[14]=n[2]+M-(A*E+L*P+F*M),t[15]=1,t}function z(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,u=n*s,c=i*s,h=i*a,p=r*s,d=r*a,v=r*l,m=o*s,f=o*a,b=o*l;return t[0]=1-h-v,t[1]=c+b,t[2]=p-f,t[3]=0,t[4]=c-b,t[5]=1-u-v,t[6]=d+m,t[7]=0,t[8]=p+f,t[9]=d-m,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function K(t,e,n,i,r,o,s){var a=1/(n-e),l=1/(r-i),u=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0,t}function H(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var q=H;function G(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=r*o,t[14]=r*i*o):(t[10]=-1,t[14]=-i),t}function W(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+a),u=2/(r+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(s-a)*l*.5,t[9]=(r-o)*u*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function X(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*u,t[15]=1,t}var $=X;function Y(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=o*u,t[15]=1,t}function Q(t,e,n,i){var r,o,s,a,l,u,c,h,p,d,v=e[0],m=e[1],f=e[2],_=i[0],g=i[1],w=i[2],x=n[0],y=n[1],C=n[2];return Math.abs(v-x)<1e-6&&Math.abs(m-y)<1e-6&&Math.abs(f-C)<1e-6?b(t):(c=v-x,h=m-y,p=f-C,r=g*(p*=d=1/Math.hypot(c,h,p))-w*(h*=d),o=w*(c*=d)-_*p,s=_*h-g*c,(d=Math.hypot(r,o,s))?(r*=d=1/d,o*=d,s*=d):(r=0,o=0,s=0),a=h*s-p*o,l=p*r-c*s,u=c*o-h*r,(d=Math.hypot(a,l,u))?(a*=d=1/d,l*=d,u*=d):(a=0,l=0,u=0),t[0]=r,t[1]=a,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=u,t[10]=p,t[11]=0,t[12]=-(r*v+o*m+s*f),t[13]=-(a*v+l*m+u*f),t[14]=-(c*v+h*m+p*f),t[15]=1,t)}function Z(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=i[0],l=i[1],u=i[2],c=r-n[0],h=o-n[1],p=s-n[2],d=c*c+h*h+p*p;d>0&&(c*=d=1/Math.sqrt(d),h*=d,p*=d);var v=l*p-u*h,m=u*c-a*p,f=a*h-l*c;return(d=v*v+m*m+f*f)>0&&(v*=d=1/Math.sqrt(d),m*=d,f*=d),t[0]=v,t[1]=m,t[2]=f,t[3]=0,t[4]=h*f-p*m,t[5]=p*v-c*f,t[6]=c*m-h*v,t[7]=0,t[8]=c,t[9]=h,t[10]=p,t[11]=0,t[12]=r,t[13]=o,t[14]=s,t[15]=1,t}function J(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function tt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function et(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function nt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function it(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function rt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function ot(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function st(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],d=t[11],v=t[12],m=t[13],f=t[14],b=t[15],_=e[0],g=e[1],w=e[2],x=e[3],y=e[4],C=e[5],E=e[6],P=e[7],M=e[8],k=e[9],V=e[10],A=e[11],R=e[12],T=e[13],L=e[14],S=e[15];return Math.abs(n-_)<=1e-6*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-g)<=1e-6*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(r-w)<=1e-6*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(o-x)<=1e-6*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-y)<=1e-6*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(a-C)<=1e-6*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(l-E)<=1e-6*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-P)<=1e-6*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(c-M)<=1e-6*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(h-k)<=1e-6*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(p-V)<=1e-6*Math.max(1,Math.abs(p),Math.abs(V))&&Math.abs(d-A)<=1e-6*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(v-R)<=1e-6*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(m-T)<=1e-6*Math.max(1,Math.abs(m),Math.abs(T))&&Math.abs(f-L)<=1e-6*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(b-S)<=1e-6*Math.max(1,Math.abs(b),Math.abs(S))}var at=y,lt=nt,ut={};e(ut,"create",(function(){return le})),e(ut,"identity",(function(){return ue})),e(ut,"setAxisAngle",(function(){return ce})),e(ut,"getAxisAngle",(function(){return he})),e(ut,"getAngle",(function(){return pe})),e(ut,"dot",(function(){return ze})),e(ut,"multiply",(function(){return de})),e(ut,"rotateX",(function(){return ve})),e(ut,"rotateY",(function(){return me})),e(ut,"rotateZ",(function(){return fe})),e(ut,"calculateW",(function(){return be})),e(ut,"exp",(function(){return _e})),e(ut,"ln",(function(){return ge})),e(ut,"pow",(function(){return we})),e(ut,"scale",(function(){return je})),e(ut,"slerp",(function(){return xe})),e(ut,"random",(function(){return ye})),e(ut,"invert",(function(){return Ce})),e(ut,"conjugate",(function(){return Ee})),e(ut,"fromMat3",(function(){return Pe})),e(ut,"fromEuler",(function(){return Me})),e(ut,"str",(function(){return ke})),e(ut,"clone",(function(){return Fe})),e(ut,"fromValues",(function(){return De})),e(ut,"copy",(function(){return Ue})),e(ut,"set",(function(){return Ie})),e(ut,"add",(function(){return Ne})),e(ut,"mul",(function(){return Oe})),e(ut,"lerp",(function(){return Ke})),e(ut,"length",(function(){return He})),e(ut,"len",(function(){return qe})),e(ut,"squaredLength",(function(){return Ge})),e(ut,"sqrLen",(function(){return We})),e(ut,"normalize",(function(){return Xe})),e(ut,"exactEquals",(function(){return $e})),e(ut,"equals",(function(){return Ye})),e(ut,"rotationTo",(function(){return Qe})),e(ut,"sqlerp",(function(){return Ze})),e(ut,"setAxes",(function(){return Je}));var ct={};function ht(){var t=new c(3);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function pt(t){var e=new c(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function dt(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function vt(t,e,n){var i=new c(3);return i[0]=t,i[1]=e,i[2]=n,i}function mt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ft(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function bt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function _t(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function gt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function wt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function xt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function yt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Ct(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Et(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Pt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Mt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function kt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function Vt(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function At(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function Rt(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function Tt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Lt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function St(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Bt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ft(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s,t}function Dt(t,e,n,i){var r=e[0],o=e[1],s=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t}function Ut(t,e,n,i,r,o){var s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,u=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+n[0]*l+i[0]*u+r[0]*c,t[1]=e[1]*a+n[1]*l+i[1]*u+r[1]*c,t[2]=e[2]*a+n[2]*l+i[2]*u+r[2]*c,t}function It(t,e,n,i,r,o){var s=1-o,a=s*s,l=o*o,u=a*s,c=3*o*a,h=3*l*s,p=l*o;return t[0]=e[0]*u+n[0]*c+i[0]*h+r[0]*p,t[1]=e[1]*u+n[1]*c+i[1]*h+r[1]*p,t[2]=e[2]*u+n[2]*c+i[2]*h+r[2]*p,t}function Nt(t,e){e=e||1;var n=2*h()*Math.PI,i=2*h()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function Ot(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}function jt(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function zt(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],u=e[2],c=r*u-o*l,h=o*a-i*u,p=i*l-r*a,d=r*p-o*h,v=o*c-i*p,m=i*h-r*c,f=2*s;return c*=f,h*=f,p*=f,d*=2,v*=2,m*=2,t[0]=a+c+d,t[1]=l+h+v,t[2]=u+p+m,t}function Kt(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Ht(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function qt(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Gt(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+s*s+a*a),u=l&&Bt(t,e)/l;return Math.acos(Math.min(Math.max(u,-1),1))}function Wt(t){return t[0]=0,t[1]=0,t[2]=0,t}function Xt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function $t(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Yt(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=1e-6*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=1e-6*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-a)<=1e-6*Math.max(1,Math.abs(r),Math.abs(a))}e(ct,"create",(function(){return ht})),e(ct,"clone",(function(){return pt})),e(ct,"length",(function(){return dt})),e(ct,"fromValues",(function(){return vt})),e(ct,"copy",(function(){return mt})),e(ct,"set",(function(){return ft})),e(ct,"add",(function(){return bt})),e(ct,"subtract",(function(){return _t})),e(ct,"multiply",(function(){return gt})),e(ct,"divide",(function(){return wt})),e(ct,"ceil",(function(){return xt})),e(ct,"floor",(function(){return yt})),e(ct,"min",(function(){return Ct})),e(ct,"max",(function(){return Et})),e(ct,"round",(function(){return Pt})),e(ct,"scale",(function(){return Mt})),e(ct,"scaleAndAdd",(function(){return kt})),e(ct,"distance",(function(){return Vt})),e(ct,"squaredDistance",(function(){return At})),e(ct,"squaredLength",(function(){return Rt})),e(ct,"negate",(function(){return Tt})),e(ct,"inverse",(function(){return Lt})),e(ct,"normalize",(function(){return St})),e(ct,"len",(function(){return ie})),e(ct,"dot",(function(){return Bt})),e(ct,"cross",(function(){return Ft})),e(ct,"lerp",(function(){return Dt})),e(ct,"hermite",(function(){return Ut})),e(ct,"bezier",(function(){return It})),e(ct,"random",(function(){return Nt})),e(ct,"transformMat4",(function(){return Ot})),e(ct,"transformMat3",(function(){return jt})),e(ct,"transformQuat",(function(){return zt})),e(ct,"rotateX",(function(){return Kt})),e(ct,"rotateY",(function(){return Ht})),e(ct,"rotateZ",(function(){return qt})),e(ct,"angle",(function(){return Gt})),e(ct,"zero",(function(){return Wt})),e(ct,"str",(function(){return Xt})),e(ct,"exactEquals",(function(){return $t})),e(ct,"equals",(function(){return Yt})),e(ct,"sub",(function(){return Zt})),e(ct,"mul",(function(){return Jt})),e(ct,"div",(function(){return te})),e(ct,"dist",(function(){return ee})),e(ct,"sqrDist",(function(){return ne})),e(ct,"sqrLen",(function(){return re})),e(ct,"forEach",(function(){return oe}));var Qt,Zt=_t,Jt=gt,te=wt,ee=Vt,ne=At,ie=dt,re=Rt,oe=(Qt=ht(),function(t,e,n,i,r,o){var s,a;for(e||(e=3),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,s=n;s<a;s+=e)Qt[0]=t[s],Qt[1]=t[s+1],Qt[2]=t[s+2],r(Qt,Qt,o),t[s]=Qt[0],t[s+1]=Qt[1],t[s+2]=Qt[2];return t});function se(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function ae(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}!function(){var t,e=(t=new c(4),c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function le(){var t=new c(4);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ue(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ce(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function he(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>1e-6?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function pe(t,e){var n=ze(t,e);return Math.acos(2*n*n-1)}function de(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=i*c+s*a+r*u-o*l,t[1]=r*c+s*l+o*a-i*u,t[2]=o*c+s*u+i*l-r*a,t[3]=s*c-i*a-r*l-o*u,t}function ve(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=o*l-r*a,t[3]=s*l-i*a,t}function me(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l-o*a,t[1]=r*l+s*a,t[2]=o*l+i*a,t[3]=s*l-r*a,t}function fe(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t}function be(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function _e(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=Math.sqrt(n*n+i*i+r*r),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return t[0]=n*l,t[1]=i*l,t[2]=r*l,t[3]=a*Math.cos(s),t}function ge(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=Math.sqrt(n*n+i*i+r*r),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=.5*Math.log(n*n+i*i+r*r+o*o),t}function we(t,e,n){return ge(t,e),je(t,t,n),_e(t,t),t}function xe(t,e,n,i){var r,o,s,a,l,u=e[0],c=e[1],h=e[2],p=e[3],d=n[0],v=n[1],m=n[2],f=n[3];return(o=u*d+c*v+h*m+p*f)<0&&(o=-o,d=-d,v=-v,m=-m,f=-f),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-i)*r)/s,l=Math.sin(i*r)/s):(a=1-i,l=i),t[0]=a*u+l*d,t[1]=a*c+l*v,t[2]=a*h+l*m,t[3]=a*p+l*f,t}function ye(t){var e=h(),n=h(),i=h(),r=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t}function Ce(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=o*a,t}function Ee(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Pe(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[s]=(e[3*s+r]+e[3*r+s])*n}return t}function Me(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(n),l=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return t[0]=o*l*c-s*a*u,t[1]=s*a*c+o*l*u,t[2]=s*l*u-o*a*c,t[3]=s*l*c+o*a*u,t}function ke(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Ve,Ae,Re,Te,Le,Se,Be,Fe=function(t){var e=new c(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},De=function(t,e,n,i){var r=new c(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},Ue=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Ie=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},Ne=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Oe=de,je=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},ze=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Ke=function(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t[3]=a+i*(n[3]-a),t},He=se,qe=He,Ge=ae,We=Ge,Xe=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=o*s,t},$e=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Ye=function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=e[2],u=e[3];return Math.abs(n-s)<=1e-6*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=1e-6*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-l)<=1e-6*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-u)<=1e-6*Math.max(1,Math.abs(o),Math.abs(u))},Qe=(Ve=ht(),Ae=vt(1,0,0),Re=vt(0,1,0),function(t,e,n){var i=Bt(e,n);return i<-.999999?(Ft(Ve,Ae,e),ie(Ve)<1e-6&&Ft(Ve,Re,e),St(Ve,Ve),ce(t,Ve,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ft(Ve,e,n),t[0]=Ve[0],t[1]=Ve[1],t[2]=Ve[2],t[3]=1+i,Xe(t,t))}),Ze=(Te=le(),Le=le(),function(t,e,n,i,r,o){return xe(Te,e,r,o),xe(Le,n,i,o),xe(t,Te,Le,2*o*(1-o)),t}),Je=(Se=new c(9),c!=Float32Array&&(Se[1]=0,Se[2]=0,Se[3]=0,Se[5]=0,Se[6]=0,Se[7]=0),Se[0]=1,Se[4]=1,Se[8]=1,Be=Se,function(t,e,n,i){return Be[0]=n[0],Be[3]=n[1],Be[6]=n[2],Be[1]=i[0],Be[4]=i[1],Be[7]=i[2],Be[2]=-e[0],Be[5]=-e[1],Be[8]=-e[2],Xe(t,Pe(t,Be))});class tn{update(){if(this.pointerDown){const t=10;this.followPos.x+=(this.pointerPos.x-this.followPos.x)/t,this.followPos.y+=(this.pointerPos.y-this.followPos.y)/t;const e={x:this.followPos.x-this.prevFollowPos.x,y:this.followPos.y-this.prevFollowPos.y};this.prevFollowPos={...this.followPos};const n=.2;this.phi=e.x*n,this.theta=e.y*n}else this.phi*=.96,this.theta*=.96;this.camera.rotation[0]-=this.theta,this.camera.rotation[1]-=this.phi;this.camera.rotation[0]>-8?this.camera.rotation[0]=-8:this.camera.rotation[0]<-80&&(this.camera.rotation[0]=-80),ut.fromEuler(this.camera.orbit,this.camera.rotation[0],this.camera.rotation[1],this.camera.rotation[2]),ct.transformQuat(this.camera.position,[0,0,this.camera.distance],this.camera.orbit),this.updateCallback()}constructor(t,e,n){this.pointerDown=!1,this.pointerDownPos={x:0,y:0},this.pointerPos={x:0,y:0},this.followPos={x:0,y:0},this.prevFollowPos={x:0,y:0},this.phi=0,this.theta=0,this.camera=e,this.updateCallback=n,t.addEventListener("pointerdown",(t=>{this.pointerDownPos={x:t.clientX,y:t.clientY},this.followPos={x:t.clientX,y:t.clientY},this.pointerPos={x:t.clientX,y:t.clientY},this.prevFollowPos={x:t.clientX,y:t.clientY},this.pointerDownCameraUp=[...this.camera.up],this.pointerDownRotation=[...this.camera.rotation],this.pointerDown=!0})),t.addEventListener("pointerup",(t=>{this.pointerDown=!1})),t.addEventListener("pointermove",(t=>{this.pointerDown&&(this.pointerPos={x:t.clientX,y:t.clientY})}))}}function en(t,e,n){this.x=t,this.y=e,this.z=n}en.prototype.dot2=function(t,e){return this.x*t+this.y*e},en.prototype.dot3=function(t,e,n){return this.x*t+this.y*e+this.z*n};var nn=[new en(1,1,0),new en(-1,1,0),new en(1,-1,0),new en(-1,-1,0),new en(1,0,1),new en(-1,0,1),new en(1,0,-1),new en(-1,0,-1),new en(0,1,1),new en(0,-1,1),new en(0,1,-1),new en(0,-1,-1)],rn=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],on=new Array(512),sn=new Array(512);!function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var n;n=1&e?rn[e]^255&t:rn[e]^t>>8&255,on[e]=on[e+256]=n,sn[e]=sn[e+256]=nn[n%12]}}(0);var an=.5*(Math.sqrt(3)-1),ln=(3-Math.sqrt(3))/6;var un=new WeakSet,cn=new WeakSet,hn=new WeakSet,pn=new WeakSet,dn=new WeakSet,vn=new WeakSet,mn=new WeakSet,fn=new WeakSet,bn=new WeakSet,_n=new WeakSet,gn=new WeakSet,wn=new WeakSet,xn=new WeakSet,yn=new WeakSet,Cn=new WeakSet,En=new WeakSet,Pn=new WeakSet,Mn=new WeakSet;class kn{resize(){const t=this.gl;a(this,En,Wn).call(this,t.canvas),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),a(this,xn,Hn).call(this,t),a(this,Cn,Gn).call(this,t)}run(t=0){if(s(this,Rn,t-o(this,Vn)),s(this,Vn,t),s(this,An,o(this,An)+o(this,Rn)/16),o(this,Tn))return;this.control.update();const e=u.create();u.invert(e,this.drawUniforms.u_worldMatrix),u.transpose(this.drawUniforms.u_worldInverseTransposeMatrix,e),a(this,un,Ln).call(this),requestAnimationFrame((t=>this.run(t)))}destroy(){s(this,Tn,!0)}constructor(t,e,n=null){l(this,"oninit",void 0),Vn.set(this,{writable:!0,value:0}),An.set(this,{writable:!0,value:0}),Rn.set(this,{writable:!0,value:0}),Tn.set(this,{writable:!0,value:!1}),l(this,"camera",{matrix:u.create(),near:80,far:350,distance:150,orbit:ut.create(),position:ct.create(),rotation:ct.create(),up:ct.fromValues(0,1,0)}),l(this,"blur",{radius:7,scale:2}),un.add(this),cn.add(this),hn.add(this),pn.add(this),dn.add(this),vn.add(this),mn.add(this),fn.add(this),bn.add(this),_n.add(this),gn.add(this),wn.add(this),xn.add(this),yn.add(this),Cn.add(this),En.add(this),Pn.add(this),Mn.add(this),this.canvas=t,this.pane=e,this.oninit=n,a(this,hn,Bn).call(this)}}var Vn=new WeakMap,An=new WeakMap,Rn=new WeakMap,Tn=new WeakMap;function Ln(){const t=this.gl;t.enable(t.DEPTH_TEST),t.disable(t.CULL_FACE),a(this,gn,zn).call(this,t,this.drawFramebuffer,this.drawFramebufferWidth,this.drawFramebufferHeight),t.useProgram(this.drawProgram),t.bindVertexArray(this.objectVAO),t.uniformMatrix4fv(this.drawLocations.u_worldMatrix,!1,this.drawUniforms.u_worldMatrix),t.uniformMatrix4fv(this.drawLocations.u_viewMatrix,!1,this.drawUniforms.u_viewMatrix),t.uniformMatrix4fv(this.drawLocations.u_projectionMatrix,!1,this.drawUniforms.u_projectionMatrix),t.uniformMatrix4fv(this.drawLocations.u_worldInverseTransposeMatrix,!1,this.drawUniforms.u_worldInverseTransposeMatrix),t.uniform3f(this.drawLocations.u_cameraPosition,this.camera.position[0],this.camera.position[1],this.camera.position[2]),t.uniform1f(this.drawLocations.u_frames,o(this,An)),t.clearBufferfv(t.COLOR,0,[0,0,0,0]),t.clearBufferfv(t.DEPTH,0,[1]),t.drawElements(t.TRIANGLES,this.objectBuffers.numElem,t.UNSIGNED_SHORT,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.SRC_COLOR),t.blendEquation(t.FUNC_SUBTRACT),t.useProgram(this.portalProgram),t.bindVertexArray(this.centerObjectVAO),t.uniformMatrix4fv(this.portalLocations.u_worldMatrix,!1,this.portalUniforms.u_worldMatrix),t.uniformMatrix4fv(this.portalLocations.u_viewMatrix,!1,this.drawUniforms.u_viewMatrix),t.uniformMatrix4fv(this.portalLocations.u_projectionMatrix,!1,this.drawUniforms.u_projectionMatrix),t.uniform1f(this.portalLocations.u_frames,o(this,An)),t.drawArrays(t.TRIANGLES,0,this.centerObjectBuffers.numElem),t.disable(t.BLEND),a(this,gn,zn).call(this,t,null,t.drawingBufferWidth,t.drawingBufferHeight),t.bindFramebuffer(t.READ_FRAMEBUFFER,this.drawFramebuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.blitFramebuffer),t.clearBufferfv(t.COLOR,0,[0,0,0,1]),t.clearBufferfv(t.DEPTH,0,[0]),t.blitFramebuffer(0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,t.COLOR_BUFFER_BIT,t.NEAREST),t.blitFramebuffer(0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,t.DEPTH_BUFFER_BIT,t.NEAREST),a(this,gn,zn).call(this,t,null,t.drawingBufferWidth,t.drawingBufferHeight),a(this,cn,Sn).call(this,this.hexBlur1Framebuffer,this.drawFramebufferWidth,this.drawFramebufferHeight,this.hexBlur1Program,[[this.hexBlur1Locations.u_colorTexture,this.colorTexture],[this.hexBlur1Locations.u_depthTexture,this.depthTexture]],[[this.hexBlur1Locations.u_radiusScale,this.blur.scale]],[[this.hexBlur1Locations.u_maxCoCRadius,this.blur.radius]]),a(this,cn,Sn).call(this,this.hexBlur2Framebuffer,this.drawFramebufferWidth,this.drawFramebufferHeight,this.hexBlur2Program,[[this.hexBlur2Locations.u_verticalBlurTexture,this.hex1VerticalBlurTexture],[this.hexBlur2Locations.u_diagonalBlurTexture,this.hex1DiagonalBlurTexture],[this.hexBlur2Locations.u_depthTexture,this.depthTexture]],[[this.hexBlur2Locations.u_radiusScale,this.blur.scale]],[[this.hexBlur2Locations.u_maxCoCRadius,this.blur.radius]]),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.useProgram(this.compositeProgram),t.bindVertexArray(this.quadVAO),t.uniform1i(this.compositeLocations.u_texture,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.hex2BlurTexture),t.drawArrays(t.TRIANGLES,0,this.quadBuffers.numElem)}function Sn(t,e,n,i,r,o=[],s=[]){const l=this.gl;a(this,gn,zn).call(this,l,t,e,n),l.useProgram(i),l.clearColor(0,0,0,1),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.bindVertexArray(this.quadVAO),r.forEach((([t,e],n)=>{l.uniform1i(t,n),l.activeTexture(l[`TEXTURE${n}`]),l.bindTexture(l.TEXTURE_2D,e)})),o.forEach((([t,e])=>{l.uniform1f(t,e)})),s.forEach((([t,e])=>{l.uniform1i(t,e)})),l.drawArrays(l.TRIANGLES,0,this.quadBuffers.numElem),a(this,gn,zn).call(this,l,null,l.drawingBufferWidth,l.drawingBufferHeight)}function Bn(){this.gl=this.canvas.getContext("webgl2",{antialias:!1,alpha:!1});const e=this.gl;if(!e)throw new Error("No WebGL 2 context!");this.drawProgram=a(this,_n,jn).call(this,e,[t("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_worldInverseTransposeMatrix;\nuniform vec3 u_cameraPosition;\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\n\nout vec3 v_position;\nout vec3 v_viewPosition;\nout vec3 v_normal;\nout vec2 v_uv;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_uv = a_uv;\n    v_normal = (u_worldInverseTransposeMatrix * vec4(a_normal, 0.)).xyz;\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n    v_surfaceToView = u_cameraPosition - worldPosition.xyz;\n    v_position = a_position.xyz;\n    v_viewPosition = viewPosition.xyz;\n}\n"),t("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform float u_frames;\n\nin vec3 v_position;\nin vec3 v_normal;\nin vec2 v_uv;\nin vec3 v_surfaceToView;\nin vec3 v_viewPosition;\n\nout vec4 outColor;\n\nfloat hash(vec2 p) {\n    p = fract(p * vec2(153.343, 414.3234));\n    p += dot(p, p + 44.463);\n    return fract(p.x * p.y);\n}\n\n//\tSimplex 3D Noise \n//\tby Ian McEwan, Ashima Arts\n//\nvec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\nvec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\n\nfloat snoise(vec3 v){ \n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  // First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  // Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //  x0 = x0 - 0. + 0.0 * C \n  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n  // Permutations\n  i = mod(i, 289.0 ); \n  vec4 p = permute( permute( permute( \n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  // Gradients\n  // ( N*N points uniformly over a square, mapped onto an octahedron.)\n  float n_ = 1.0/7.0; // N=7\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  //Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  // Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat sparkle(vec2 p, float seed) {\n    vec2 id = floor(p);\n    vec2 suv = fract(p) * 2. - 1.;\n    \n    float r = hash(id);\n    float x = fract(r * 54.32);\n    float y = fract(r * 432.33);\n    vec2 offs = vec2(x, y) * 2. - 1.;\n    \n    float d = length(suv - offs);\n    float m = 1. - smoothstep(.0, .12, d);\n    \n    m *= pow(sin(seed + r), 5.);\n    return abs(m);\n}\n\nvoid main() {\n    vec3 pos = v_position;\n    vec3 n = normalize(v_normal);\n    vec3 v = normalize(v_surfaceToView);\n    vec3 l = vec3(0., 1., 0.);\n\n    float nDL = dot(n, l);\n\n    // calculate the reflection vector\n    float nDv = dot(n, v);\n    vec3 r = nDv * n * 2. - v;\n    r = normalize(r);\n\n    // fade the color to black by the distance from the center\n    float fade = 1. - smoothstep(0.2, 1., length(pos.xy) * 0.25);\n    float sparkleFade = 1. - smoothstep(0.9, 1., length(pos.xy) * 0.25);\n\n    // surface shade\n    float shade = nDL * 0.8 + (snoise(r * .5)) * 0.3;\n    shade *= 0.7;\n\n    // create the sand sparkle effect\n    float t = u_frames * 0.0;\n    float sLayer1 = sparkle(pos.xy * 6., t + abs(dot(r + v_viewPosition * 0.01, vec3(10.))));\n    float sLayer2 = sparkle(pos.xy * 12., t + abs(dot(r + v_viewPosition * 0.01, vec3(9.))));\n\n    outColor = vec4(vec3(shade * shade * fade + sLayer1 * sparkleFade + sLayer2 * sparkleFade * 0.7), 1.);\n    outColor.rgb += r * 0.02;\n}\n")],null,{a_position:0,a_normal:1,a_uv:2}),this.portalProgram=a(this,_n,jn).call(this,e,[t("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\n\nin vec3 a_position;\nin vec2 a_uv;\n\nout vec3 v_position;\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    vec4 worldPosition = u_worldMatrix * vec4(a_position, 1.);\n    vec4 viewPosition = u_viewMatrix * worldPosition;\n    gl_Position = u_projectionMatrix * viewPosition;\n}\n"),t("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform float u_frames;\n\nin vec3 v_position;\nin vec2 v_uv;\n\nout vec4 outColor;\n\nfloat hash(vec2 p) {\n    p = fract(p * vec2(153.343, 414.3234));\n    p += dot(p, p + 44.463);\n    return fract(p.x * p.y);\n}\n\n//\tSimplex 3D Noise \n//\tby Ian McEwan, Ashima Arts\n//\nvec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\nvec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\n\nfloat snoise(vec3 v){ \n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  // First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  // Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //  x0 = x0 - 0. + 0.0 * C \n  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n  // Permutations\n  i = mod(i, 289.0 ); \n  vec4 p = permute( permute( permute( \n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  // Gradients\n  // ( N*N points uniformly over a square, mapped onto an octahedron.)\n  float n_ = 1.0/7.0; // N=7\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  //Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  // Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvoid main() {\n    vec3 pos = v_position;\n    float n = snoise(vec3(vec2(v_uv.x * 0.001, v_uv.y * 2. - u_frames * 0.008) * 2., u_frames * 0.01)) * 2. - 1.;\n    vec3 color = vec3(0.); //vec3(0.8, 0.9, 1.) * (n * 0.5);\n    outColor = vec4(color, .7);\n    outColor = vec4(0.6, 0.8, 0.8, 1.) * 0.7;\n}\n")],null,{a_position:0,a_uv:2}),this.hexBlur1Program=a(this,_n,jn).call(this,e,[t("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0., 1.);\n}"),t("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_colorTexture;\nuniform sampler2D u_depthTexture;\nuniform int u_maxCoCRadius;\nuniform float u_radiusScale;\n\nlayout(location = 0) out vec4 verticalBlurColor;\nlayout(location = 1) out vec4 diagnoalBlurColor;\n\nbool inNearField(float radiusPixels) {\n    return radiusPixels > 0.25;\n}\n\nfloat getRadius(float depth) {\n    return clamp(smoothstep(.65, 1., depth), 0.001, 1.);\n}\n\nvoid blur(\n    in vec2 A,\n    in vec2 direction,\n    in int maxCoCRadius,\n    in float radiusScale,\n    in sampler2D inTexture,\n    in sampler2D depthTexture,\n    in vec2 off,\n    out vec4 outColor\n) {\n    vec4 resultColor = vec4(0.);\n    float weightSum = 0.;\n\n    // position of the current pixel\n    vec2 texelSize = 1. / vec2(textureSize(inTexture, 0));\n    vec4 colorA = texture(inTexture, A);\n    float depthA = texture(depthTexture, A).x;\n    float rA = getRadius(depthA) * float(maxCoCRadius);\n    int irA = int(floor(rA)) * 2;\n\n    // scatter as you gather loop\n    for(int delta = 0; delta <= irA; ++delta) {\n\n        // get the CoC radius at this tap\n        vec2 B = A + direction * ((float(delta) * radiusScale + off) * texelSize);\n        vec4 colorB = texture(inTexture, B);\n        float depthB = texture(depthTexture, B).x;\n        float rB = getRadius(depthB) * float(maxCoCRadius);\n\n        // get the effect of the CoC at B on the current pixel at A\n        float blurWeight = clamp((rB / float(maxCoCRadius)) * 4., 0., 1.);\n\n        // only consider if B is in front of A\n        float bNearerWeight = clamp(abs(rA) - abs(rB) + 1.5, 0., 1.);\n\n        // get the weight for mid and far field values\n        float weight = bNearerWeight * blurWeight;\n\n        // update the mid/far result\n        weightSum += weight;\n        resultColor.rgb += colorB.rgb * weight;\n    }\n\n    // apply total weights\n    resultColor.rgb /= weightSum;\n    resultColor.a = rA / float(maxCoCRadius);\n\n    outColor = resultColor;\n}\n\n#define PI 3.141593\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_colorTexture, 0));\n\n    blur(\n        uv,\n        vec2(0., -1.),\n        u_maxCoCRadius,\n        u_radiusScale,\n        u_colorTexture,\n        u_depthTexture,\n        vec2(0.5),\n        verticalBlurColor\n    );\n\n    blur(\n        uv,\n        vec2(cos(PI / 6.), sin(PI / 6.)),\n        u_maxCoCRadius,\n        u_radiusScale,\n        u_colorTexture,\n        u_depthTexture,\n        vec2(0.5),\n        diagnoalBlurColor\n    );\n\n    diagnoalBlurColor = verticalBlurColor + diagnoalBlurColor;\n}")],null,{a_position:0}),this.hexBlur2Program=a(this,_n,jn).call(this,e,[t("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0., 1.);\n}"),t("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_verticalBlurTexture;\nuniform sampler2D u_diagonalBlurTexture;\nuniform sampler2D u_depthTexture;\nuniform int u_maxCoCRadius;\nuniform float u_radiusScale;\n\nlayout(location = 0) out vec4 outColor;\n\nbool inNearField(float radiusPixels) {\n    return radiusPixels > 0.25;\n}\n\nfloat getRadius(float depth) {\n    return clamp(smoothstep(.65, 1., depth), 0.001, 1.);\n}\n\nvoid blur(\n    in vec2 A,\n    in vec2 direction,\n    in int maxCoCRadius,\n    in float radiusScale,\n    in sampler2D inTexture,\n    in sampler2D depthTexture,\n    in vec2 off,\n    out vec4 outColor\n) {\n    vec4 resultColor = vec4(0.);\n    float weightSum = 0.;\n\n    // position of the current pixel\n    vec2 texelSize = 1. / vec2(textureSize(inTexture, 0));\n    vec4 colorA = texture(inTexture, A);\n    float depthA = texture(depthTexture, A).x;\n    float rA = getRadius(depthA) * float(maxCoCRadius);\n    int irA = int(floor(rA)) * 2;\n\n    // scatter as you gather loop\n    for(int delta = 0; delta <= irA; ++delta) {\n\n        // get the CoC radius at this tap\n        vec2 B = A + direction * ((float(delta) * radiusScale + off) * texelSize);\n        vec4 colorB = texture(inTexture, B);\n        float depthB = texture(depthTexture, B).x;\n        float rB = getRadius(depthB) * float(maxCoCRadius);\n\n        // get the effect of the CoC at B on the current pixel at A\n        float blurWeight = clamp((rB / float(maxCoCRadius)) * 4., 0., 1.);\n\n        // only consider if B is in front of A\n        float bNearerWeight = clamp(abs(rA) - abs(rB) + 1.5, 0., 1.);\n\n        // get the weight for mid and far field values\n        float weight = bNearerWeight * blurWeight;\n\n        // update the mid/far result\n        weightSum += weight;\n        resultColor.rgb += colorB.rgb * weight;\n    }\n\n    // apply total weights\n    resultColor.rgb /= weightSum;\n    resultColor.a = rA / float(maxCoCRadius);\n\n    outColor = resultColor;\n}\n\n#define PI 3.141593\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_verticalBlurTexture, 0));\n    vec4 verticalBlurColor = texture(u_verticalBlurTexture, uv);\n    vec4 diagnoalBlurColor = texture(u_diagonalBlurTexture, uv);\n    float depth = texture(u_depthTexture, uv).x;\n    vec4 resultColor1;\n    vec4 resultColor2;\n\n    blur(\n        uv,\n        vec2(cos(PI / 6.), sin(PI / 6.)),\n        u_maxCoCRadius,\n        u_radiusScale,\n        u_verticalBlurTexture,\n        u_depthTexture,\n        vec2(0.5),\n        resultColor1\n    );\n\n    blur(\n        uv,\n        vec2(cos((5. * PI) / 6.), sin((5. * PI) / 6.)),\n        u_maxCoCRadius,\n        u_radiusScale,\n        u_diagonalBlurTexture,\n        u_depthTexture,\n        vec2(0.5),\n        resultColor2\n    );\n\n    diagnoalBlurColor = (resultColor1 + resultColor2) * .5;\n\n    outColor = diagnoalBlurColor;\n}")],null,{a_position:0}),this.compositeProgram=a(this,_n,jn).call(this,e,[t("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0., 1.);\n}"),t("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_texture;\n\nout vec4 outColor;\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / vec2(textureSize(u_texture, 0));\n    vec4 color = texture(u_texture, uv);\n    float s1 = 0.5;\n    float s2 = 0.8;\n    vec4 boost = smoothstep(s1, s2, color) - smoothstep(s2, s2 + 0.1 , color);\n    outColor = color + boost.rrra * 0.6;\n}")],null,{a_position:0}),this.drawLocations={a_position:e.getAttribLocation(this.drawProgram,"a_position"),a_normal:e.getAttribLocation(this.drawProgram,"a_normal"),a_uv:e.getAttribLocation(this.drawProgram,"a_uv"),u_worldMatrix:e.getUniformLocation(this.drawProgram,"u_worldMatrix"),u_viewMatrix:e.getUniformLocation(this.drawProgram,"u_viewMatrix"),u_projectionMatrix:e.getUniformLocation(this.drawProgram,"u_projectionMatrix"),u_worldInverseTransposeMatrix:e.getUniformLocation(this.drawProgram,"u_worldInverseTransposeMatrix"),u_cameraPosition:e.getUniformLocation(this.drawProgram,"u_cameraPosition"),u_frames:e.getUniformLocation(this.drawProgram,"u_frames")},this.portalLocations={a_position:e.getAttribLocation(this.portalProgram,"a_position"),a_uv:e.getAttribLocation(this.portalProgram,"a_uv"),u_worldMatrix:e.getUniformLocation(this.portalProgram,"u_worldMatrix"),u_viewMatrix:e.getUniformLocation(this.portalProgram,"u_viewMatrix"),u_projectionMatrix:e.getUniformLocation(this.portalProgram,"u_projectionMatrix"),u_frames:e.getUniformLocation(this.portalProgram,"u_frames")},this.hexBlur1Locations={a_position:e.getAttribLocation(this.hexBlur1Program,"a_position"),u_colorTexture:e.getUniformLocation(this.hexBlur1Program,"u_colorTexture"),u_depthTexture:e.getUniformLocation(this.hexBlur1Program,"u_depthTexture"),u_maxCoCRadius:e.getUniformLocation(this.hexBlur1Program,"u_maxCoCRadius"),u_radiusScale:e.getUniformLocation(this.hexBlur1Program,"u_radiusScale")},this.hexBlur2Locations={a_position:e.getAttribLocation(this.hexBlur2Program,"a_position"),u_verticalBlurTexture:e.getUniformLocation(this.hexBlur2Program,"u_verticalBlurTexture"),u_diagonalBlurTexture:e.getUniformLocation(this.hexBlur2Program,"u_diagonalBlurTexture"),u_depthTexture:e.getUniformLocation(this.hexBlur2Program,"u_depthTexture"),u_maxCoCRadius:e.getUniformLocation(this.hexBlur2Program,"u_maxCoCRadius"),u_radiusScale:e.getUniformLocation(this.hexBlur2Program,"u_radiusScale")},this.compositeLocations={a_position:e.getAttribLocation(this.compositeProgram,"a_position"),u_texture:e.getUniformLocation(this.compositeProgram,"u_texture")},this.drawUniforms={u_worldMatrix:u.create(),u_viewMatrix:u.create(),u_projectionMatrix:u.create(),u_worldInverseTransposeMatrix:u.create()},u.rotate(this.drawUniforms.u_worldMatrix,this.drawUniforms.u_worldMatrix,-Math.PI/2,[1,0,0]),u.scale(this.drawUniforms.u_worldMatrix,this.drawUniforms.u_worldMatrix,[50,50,50]),u.translate(this.drawUniforms.u_worldMatrix,this.drawUniforms.u_worldMatrix,[0,0,0]),this.portalUniforms={u_worldMatrix:u.create()},u.translate(this.portalUniforms.u_worldMatrix,this.portalUniforms.u_worldMatrix,[0,5,0]);this.objectGeometry=a(this,pn,Fn).call(this,8,8,110,110,(t=>{const e=function(t,e){var n,i,r=(t+e)*an,o=Math.floor(t+r),s=Math.floor(e+r),a=(o+s)*ln,l=t-o+a,u=e-s+a;l>u?(n=1,i=0):(n=0,i=1);var c=l-n+ln,h=u-i+ln,p=l-1+2*ln,d=u-1+2*ln,v=sn[(o&=255)+on[s&=255]],m=sn[o+n+on[s+i]],f=sn[o+1+on[s+1]],b=.5-l*l-u*u,_=.5-c*c-h*h,g=.5-p*p-d*d;return 70*((b<0?0:(b*=b)*b*v.dot2(l,u))+(_<0?0:(_*=_)*_*m.dot2(c,h))+(g<0?0:(g*=g)*g*f.dot2(p,d)))}(.9*t.x,.9*t.y);let n=ct.length([t.x,t.y,t.z])/4*1;const i=Math.sin(Math.acos(t.x/5))*Math.cos(Math.asin(t.y/5));return{x:t.x,y:t.y,z:.4*e*n-6.5*i+5.3}})),this.objectBuffers={position:a(this,dn,Dn).call(this,e,this.objectGeometry.vertices),normal:a(this,dn,Dn).call(this,e,this.objectGeometry.normals),uv:a(this,dn,Dn).call(this,e,this.objectGeometry.uvs),numElem:this.objectGeometry.count},this.objectVAO=a(this,fn,Nn).call(this,e,[[this.objectBuffers.position,this.drawLocations.a_position,3],[this.objectBuffers.normal,this.drawLocations.a_normal,3],[this.objectBuffers.uv,this.drawLocations.a_uv,2]],this.objectGeometry.indices);const n=[-1,-1,3,-1,-1,3];this.quadBuffers={position:a(this,dn,Dn).call(this,e,n),numElem:n.length/2},this.quadVAO=a(this,fn,Nn).call(this,e,[[this.quadBuffers.position,this.drawLocations.a_position,2]]);const i=30,r=-Math.PI/2,o=[Math.cos(0+r)*i,Math.sin(0+r)*i,0,Math.cos(2*Math.PI/3+r)*i,Math.sin(2*Math.PI/3+r)*i,0,Math.cos(4*Math.PI/3+r)*i,Math.sin(4*Math.PI/3+r)*i,0];this.centerObjectBuffers={position:a(this,dn,Dn).call(this,e,o),uv:a(this,dn,Dn).call(this,e,[0,0,0,1,1,1]),numElem:o.length/3},this.centerObjectVAO=a(this,fn,Nn).call(this,e,[[this.centerObjectBuffers.position,this.portalLocations.a_position,3],[this.centerObjectBuffers.uv,this.portalLocations.a_uv,2]]);const s=e.canvas.clientWidth,l=e.canvas.clientHeight;this.drawFramebufferWidth=s,this.drawFramebufferHeight=l,this.drawFramebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.drawFramebuffer),this.depthRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.depthRenderbuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,4,e.DEPTH_COMPONENT32F,this.drawFramebufferWidth,this.drawFramebufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthRenderbuffer),this.colorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.colorRenderbuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,e.getParameter(e.MAX_SAMPLES),e.RGBA8,this.drawFramebufferWidth,this.drawFramebufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,this.colorRenderbuffer),e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE&&console.error("could not complete render framebuffer setup"),this.blitFramebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.blitFramebuffer),this.depthTexture=a(this,wn,Kn).call(this,e,e.NEAREST,e.NEAREST),e.bindTexture(e.TEXTURE_2D,this.depthTexture),e.texImage2D(this.gl.TEXTURE_2D,0,e.DEPTH_COMPONENT32F,this.drawFramebufferWidth,this.drawFramebufferHeight,0,e.DEPTH_COMPONENT,e.FLOAT,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthTexture,0),this.colorTexture=a(this,wn,Kn).call(this,e,e.LINEAR,e.LINEAR),e.bindTexture(e.TEXTURE_2D,this.colorTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.colorTexture,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE&&console.error("could not complete render framebuffer setup"),this.hex1VerticalBlurTexture=a(this,wn,Kn).call(this,e,e.LINEAR,e.LINEAR),e.bindTexture(e.TEXTURE_2D,this.hex1VerticalBlurTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,e.RGBA,e.UNSIGNED_BYTE,null),this.hex1DiagonalBlurTexture=a(this,wn,Kn).call(this,e,e.LINEAR,e.LINEAR),e.bindTexture(e.TEXTURE_2D,this.hex1DiagonalBlurTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,e.RGBA,e.UNSIGNED_BYTE,null),this.hexBlur1Framebuffer=a(this,mn,In).call(this,e,[this.hex1VerticalBlurTexture,this.hex1DiagonalBlurTexture]),e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE&&console.error("could not complete blur hexagonal first pass framebuffer setup"),this.hex2BlurTexture=a(this,wn,Kn).call(this,e,e.LINEAR,e.LINEAR),e.bindTexture(e.TEXTURE_2D,this.hex2BlurTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,e.RGBA,e.UNSIGNED_BYTE,null),this.hexBlur2Framebuffer=a(this,mn,In).call(this,e,[this.hex2BlurTexture]),e.checkFramebufferStatus(e.FRAMEBUFFER)!=e.FRAMEBUFFER_COMPLETE&&console.error("could not complete blur hexagonal second pass framebuffer setup"),this.resize(),a(this,yn,qn).call(this),a(this,Cn,Gn).call(this,e),a(this,vn,Un).call(this),a(this,Pn,Xn).call(this),this.oninit&&this.oninit(this)}function Fn(t,e,n,i,r){let o=-t/2,s=-e/2;const a=t/n,l=e/i,u=n*i*6,c=[],h=[],p=[],d=[],v=n+1,m=.5*Math.min(a,l);for(let t=0;t<=i;++t)for(let e=0;e<=n;++e){let u={x:o+a*e,y:s+l*t,z:0},d={x:0,y:0,z:1};if(r){let t={...u},e={...u},n={...u},i={...u};t.x-=m,e.x+=m,n.y-=m,i.y+=m,t=r(t),e=r(e),n=r(n),i=r(i);let o=ct.fromValues(e.x-t.x,e.y-t.y,e.z-t.z),s=ct.fromValues(i.x-n.x,i.y-n.y,i.z-n.z);const a=ct.cross(ct.create(),o,s);ct.normalize(a,a),d.x=a[0],d.y=a[1],d.z=a[2],u=r(u)}c.push(u.x,u.y,u.z),h.push(d.x,d.y,d.z),p.push(e/n,t/i)}for(let t=0;t<i;++t)for(let e=0;e<n;++e)d.push(t*v+e,t*v+e+1,(t+1)*v+e+1),d.push((t+1)*v+e+1,(t+1)*v+e,t*v+e);return{vertices:c,normals:h,uvs:p,indices:d,count:u}}function Dn(t,e){const n=this.gl.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),n}function Un(){this.control=new tn(this.canvas,this.camera,(()=>a(this,yn,qn).call(this)))}function In(t,e){const n=t.createFramebuffer(),i=[];return t.bindFramebuffer(t.FRAMEBUFFER,n),e.forEach(((e,n)=>{const r=t[`COLOR_ATTACHMENT${n}`];t.framebufferTexture2D(t.FRAMEBUFFER,r,t.TEXTURE_2D,e,0),i.push(r)})),t.drawBuffers(i),t.bindFramebuffer(t.FRAMEBUFFER,null),n}function Nn(t,e,n){const i=t.createVertexArray();t.bindVertexArray(i);for(const[n,i,r]of e)-1!=i&&(t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,r,t.FLOAT,!1,0,0));if(n){const e=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),t.STATIC_DRAW)}return t.bindVertexArray(null),i}function On(t,e,n){const i=t.createShader(e);t.shaderSource(i,n),t.compileShader(i);if(t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.error(t.getShaderInfoLog(i)),t.deleteShader(i)}function jn(t,e,n,i){const r=t.createProgram();if([t.VERTEX_SHADER,t.FRAGMENT_SHADER].forEach(((n,i)=>{const o=a(this,bn,On).call(this,t,n,e[i]);t.attachShader(r,o)})),n&&t.transformFeedbackVaryings(r,n,t.SEPARATE_ATTRIBS),i)for(const e in i)t.bindAttribLocation(r,i[e],e);t.linkProgram(r);if(t.getProgramParameter(r,t.LINK_STATUS))return r;console.error(t.getProgramInfoLog(r)),t.deleteProgram(r)}function zn(t,e,n,i){t.bindFramebuffer(t.FRAMEBUFFER,e),t.viewport(0,0,n,i)}function Kn(t,e,n){const i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),i}function Hn(t){const e=t.canvas.clientWidth,n=t.canvas.clientHeight;this.drawFramebufferWidth=e,this.drawFramebufferHeight=n,t.bindRenderbuffer(t.RENDERBUFFER,this.depthRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH_COMPONENT32F,e,n),t.bindRenderbuffer(t.RENDERBUFFER,this.colorRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,t.getParameter(t.MAX_SAMPLES),t.RGBA8,e,n),t.bindTexture(t.TEXTURE_2D,this.depthTexture),t.texImage2D(this.gl.TEXTURE_2D,0,t.DEPTH_COMPONENT32F,e,n,0,t.DEPTH_COMPONENT,t.FLOAT,null),t.bindTexture(t.TEXTURE_2D,this.colorTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.hex1VerticalBlurTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.hex1DiagonalBlurTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.hex2BlurTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}function qn(){u.targetTo(this.camera.matrix,this.camera.position,[0,0,0],this.camera.up),u.invert(this.drawUniforms.u_viewMatrix,this.camera.matrix)}function Gn(t){const e=t.canvas.clientWidth/t.canvas.clientHeight;u.perspective(this.drawUniforms.u_projectionMatrix,Math.PI/4,e,this.camera.near,this.camera.far)}function Wn(t){const e=t.clientWidth,n=t.clientHeight,i=t.width!==e||t.height!==n;return i&&(t.width=e,t.height=n),i}function Xn(){if(this.pane){const t=700,e=this.pane.addFolder({title:"Camera"});a(this,Mn,$n).call(this,e,this.camera,"near","near",1,t,null,(()=>a(this,Cn,Gn).call(this,this.gl))),a(this,Mn,$n).call(this,e,this.camera,"far","far",1,t,null,(()=>a(this,Cn,Gn).call(this,this.gl)));const n=this.pane.addFolder({title:"Blur Settings"});a(this,Mn,$n).call(this,n,this.blur,"radius","radius",0,30,1),a(this,Mn,$n).call(this,n,this.blur,"scale","scale",1,5,.1)}}function $n(t,e,n,i,r,o,s=null,a){t.addBlade({view:"slider",label:i,min:r,max:o,step:s,value:e[n]}).on("change",(t=>{e[n]=t.value,a&&a()}))}const Yn=window.location.search;let Qn,Zn,Jn=null!==new URLSearchParams(Yn).get("debug");window.addEventListener("load",(()=>{const t=document.body.querySelector("#c");let e;Jn&&(e=new r.Pane({title:"Settings"})),Qn=new kn(t,e,(t=>{t.run()}))})),window.addEventListener("resize",(()=>{Qn&&(Zn&&clearTimeout(Zn),Zn=setTimeout((()=>{Zn=null,Qn.resize()}),300))}));
//# sourceMappingURL=index.9e1e9421.js.map
